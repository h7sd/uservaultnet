import{a as Xe}from"./index-D9ddz9y_.js";import{g as Ze,c as L}from"./_commonjsHelpers-Cpj98o6Y.js";import{g as et,k as tt}from"./application-DnsIlr-S.js";import{_ as rt,d as it,r as We,c as Se,o as Te,a as Ne,w as ot,j as V,t as Ue,n as nt,m as at,q as st,g as dt}from"./global.properties-ieI6Xwik.js";import"./inbox.store-DKf8FrGP.js";import"./index-CaocF3Et.js";var Ve={exports:{}};(function(F){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function y(r,e){if(!r)throw"First parameter is required.";e=e||{type:"video"},e=new se(r,e);var t=this;function a(n){return e.disableLogs||console.log("RecordRTC version: ",t.version),n&&(e=new se(r,n)),e.disableLogs||console.log("started recording "+e.type+" stream."),l?(l.clearRecordedData(),l.record(),g("recording"),t.recordingDuration&&c(),t):(d(function(){t.recordingDuration&&c()}),t)}function d(n){n&&(e.initCallback=function(){n(),n=e.initCallback=null});var v=new j(r,e);l=new v(r,e),l.record(),g("recording"),e.disableLogs||console.log("Initialized recorderType:",l.constructor.name,"for output-type:",e.type)}function s(n){if(n=n||function(){},!l){m();return}if(t.state==="paused"){t.resumeRecording(),setTimeout(function(){s(n)},1);return}t.state!=="recording"&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',t.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),e.type!=="gif"?l.stop(v):(l.stop(),v()),g("stopped");function v(C){if(!l){typeof n.call=="function"?n.call(t,""):n("");return}Object.keys(l).forEach(function(w){typeof l[w]!="function"&&(t[w]=l[w])});var o=l.blob;if(!o)if(C)l.blob=o=C;else throw"Recording failed.";if(o&&!e.disableLogs&&console.log(o.type,"->",xe(o.size)),n){var u;try{u=D.createObjectURL(o)}catch{}typeof n.call=="function"?n.call(t,u):n(u)}e.autoWriteToDisk&&b(function(w){var R={};R[e.type+"Blob"]=w,X.Store(R)})}}function f(){if(!l){m();return}if(t.state!=="recording"){e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",t.state);return}g("paused"),l.pause(),e.disableLogs||console.log("Paused recording.")}function i(){if(!l){m();return}if(t.state!=="paused"){e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",t.state);return}g("recording"),l.resume(),e.disableLogs||console.log("Resumed recording.")}function h(n){postMessage(new FileReaderSync().readAsDataURL(n))}function b(n,v){if(!n)throw"Pass a callback function over getDataURL.";var C=v?v.blob:(l||{}).blob;if(!C){e.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){b(n,v)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var o=w(h);o.onmessage=function(R){n(R.data)},o.postMessage(C)}else{var u=new FileReader;u.readAsDataURL(C),u.onload=function(R){n(R.target.result)}}function w(R){try{var x=D.createObjectURL(new Blob([R.toString(),"this.onmessage =  function (eee) {"+R.name+"(eee.data);}"],{type:"application/javascript"})),T=new Worker(x);return D.revokeObjectURL(x),T}catch{}}}function c(n){if(n=n||0,t.state==="paused"){setTimeout(function(){c(n)},1e3);return}if(t.state!=="stopped"){if(n>=t.recordingDuration){s(t.onRecordingStopped);return}n+=1e3,setTimeout(function(){c(n)},1e3)}}function g(n){t&&(t.state=n,typeof t.onStateChanged.call=="function"?t.onStateChanged.call(t,n):t.onStateChanged(n))}var p='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function m(){e.disableLogs!==!0&&console.warn(p)}var l,S={startRecording:a,stopRecording:s,pauseRecording:f,resumeRecording:i,initRecorder:d,setRecordingDuration:function(n,v){if(typeof n>"u")throw"recordingDuration is required.";if(typeof n!="number")throw"recordingDuration must be a number.";return t.recordingDuration=n,t.onRecordingStopped=v||function(){},{onRecordingStopped:function(C){t.onRecordingStopped=C}}},clearRecordedData:function(){if(!l){m();return}l.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!l){m();return}return l.blob},getDataURL:b,toURL:function(){if(!l){m();return}return D.createObjectURL(l.blob)},getInternalRecorder:function(){return l},save:function(n){if(!l){m();return}Fe(l.blob,n)},getFromDisk:function(n){if(!l){m();return}y.getFromDisk(e.type,n)},setAdvertisementArray:function(n){e.advertisement=[];for(var v=n.length,C=0;C<v;C++)e.advertisement.push({duration:C,image:n[C]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){t.state==="recording"&&!e.disableLogs&&console.warn("Stop an active recorder."),l&&typeof l.clearRecordedData=="function"&&l.clearRecordedData(),l=null,g("inactive"),t.blob=null},onStateChanged:function(n){e.disableLogs||console.log("Recorder state changed:",n)},state:"inactive",getState:function(){return t.state},destroy:function(){var n=e.disableLogs;e={disableLogs:!0},t.reset(),g("destroyed"),S=t=null,fe.AudioContextConstructor&&(fe.AudioContextConstructor.close(),fe.AudioContextConstructor=null),e.disableLogs=n,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return t=S,S;for(var k in S)this[k]=S[k];return t=this,S}y.version="5.6.2",F.exports=y,y.getFromDisk=function(r,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+(r==="all"?"blobs":r+" blob ")+" from disk!"),X.Fetch(function(t,a){r!=="all"&&a===r+"Blob"&&e&&e(t),r==="all"&&e&&e(t,a.replace("Blob",""))})},y.writeToDisk=function(r){console.log("Writing recorded blob(s) to disk!"),r=r||{},r.audio&&r.video&&r.gif?r.audio.getDataURL(function(e){r.video.getDataURL(function(t){r.gif.getDataURL(function(a){X.Store({audioBlob:e,videoBlob:t,gifBlob:a})})})}):r.audio&&r.video?r.audio.getDataURL(function(e){r.video.getDataURL(function(t){X.Store({audioBlob:e,videoBlob:t})})}):r.audio&&r.gif?r.audio.getDataURL(function(e){r.gif.getDataURL(function(t){X.Store({audioBlob:e,gifBlob:t})})}):r.video&&r.gif?r.video.getDataURL(function(e){r.gif.getDataURL(function(t){X.Store({videoBlob:e,gifBlob:t})})}):r.audio?r.audio.getDataURL(function(e){X.Store({audioBlob:e})}):r.video?r.video.getDataURL(function(e){X.Store({videoBlob:e})}):r.gif&&r.gif.getDataURL(function(e){X.Store({gifBlob:e})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function se(r,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===be||e.recorderType===ge||typeof le<"u"&&e.recorderType===le?e.type="video":e.recorderType===we?e.type="gif":e.recorderType===ve?e.type="audio":e.recorderType===G&&(M(r,"audio").length&&M(r,"video").length||!M(r,"audio").length&&M(r,"video").length?e.type="video":M(r,"audio").length&&!M(r,"video").length&&(e.type="audio"))),typeof G<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0]),e.bitsPerSecond),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function j(r,e){var t;return(J||ce||de)&&(t=ve),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!J&&(t=G),e.type==="video"&&(J||de)&&(t=be,typeof le<"u"&&typeof ReadableStream<"u"&&(t=le)),e.type==="gif"&&(t=we),e.type==="canvas"&&(t=ge),ne()&&t!==ge&&t!==we&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(M(r,"video").length||M(r,"audio").length)&&(e.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(t=G):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(t=G)),r instanceof Array&&r.length&&(t=Oe),e.recorderType&&(t=e.recorderType),!e.disableLogs&&t&&t.name&&console.log("Using recorderType:",t.name||t.constructor.name),!t&&ue&&(t=G),t}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function z(r){this.addStream=function(e){e&&(r=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e=this.mediaType,t,a=this.mimeType||{audio:null,video:null,gif:null};if(typeof e.audio!="function"&&ne()&&!M(r,"audio").length&&(e.audio=!1),typeof e.video!="function"&&ne()&&!M(r,"video").length&&(e.video=!1),typeof e.gif!="function"&&ne()&&!M(r,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(t=null,typeof e.audio=="function"&&(t=e.audio),this.audioRecorder=new y(r,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:a.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){t=null,typeof e.video=="function"&&(t=e.video);var d=r;if(ne()&&e.audio&&typeof e.audio=="function"){var s=M(r,"video")[0];me?(d=new Q,d.addTrack(s),t&&t===be&&(t=G)):(d=new Q,d.addTrack(s))}this.videoRecorder=new y(d,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:a.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var f=this,i=ne()===!0;(e.audio instanceof ve&&e.video||e.audio!==!0&&e.video!==!0&&e.audio!==e.video)&&(i=!1),i===!0?(f.audioRecorder=null,f.videoRecorder.startRecording()):f.videoRecorder.initRecorder(function(){f.audioRecorder.initRecorder(function(){f.videoRecorder.startRecording(),f.audioRecorder.startRecording()})})}e.gif&&(t=null,typeof e.gif=="function"&&(t=e.gif),this.gifRecorder=new y(r,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:a.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(t){e(t,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(t){e(t,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(t){e(t,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){this.getBlob(function(d){d.audio&&d.video?t(d.audio,function(s){t(d.video,function(f){e({audio:s,video:f})})}):d.audio?t(d.audio,function(s){e({audio:s})}):d.video&&t(d.video,function(s){e({video:s})})});function t(d,s){if(typeof Worker<"u"){var f=a(function(b){postMessage(new FileReaderSync().readAsDataURL(b))});f.onmessage=function(h){s(h.data)},f.postMessage(d)}else{var i=new FileReader;i.readAsDataURL(d),i.onload=function(h){s(h.target.result)}}}function a(d){var s=D.createObjectURL(new Blob([d.toString(),"this.onmessage =  function (eee) {"+d.name+"(eee.data);}"],{type:"application/javascript"})),f=new Worker(s),i;if(typeof D<"u")i=D;else if(typeof webkitURL<"u")i=webkitURL;else throw"Neither URL nor webkitURL detected.";return i.revokeObjectURL(s),f}},this.writeToDisk=function(){y.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save(typeof e.audio=="string"?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save(typeof e.video=="string"?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save(typeof e.gif=="string"?e.gif:"")}}z.getFromDisk=y.getFromDisk,z.writeToDisk=y.writeToDisk,typeof y<"u"&&(y.MRecordRTC=z);var ke="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(r){r&&(typeof window<"u"||typeof L>"u"||(L.navigator={userAgent:ke,getUserMedia:function(){}},L.console||(L.console={}),(typeof L.console.log>"u"||typeof L.console.error>"u")&&(L.console.error=L.console.log=L.console.log||function(){console.log(arguments)}),typeof document>"u"&&(r.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},r.HTMLVideoElement=function(){}),typeof location>"u"&&(r.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(r.screen={width:0,height:0}),typeof D>"u"&&(r.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),r.window=L))})(typeof L<"u"?L:null);var $=window.requestAnimationFrame;if(typeof $>"u"){if(typeof webkitRequestAnimationFrame<"u")$=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")$=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")$=msRequestAnimationFrame;else if(typeof $>"u"){var W=0;$=function(r,e){var t=new Date().getTime(),a=Math.max(0,16-(t-W)),d=setTimeout(function(){r(t+a)},a);return W=t+a,d}}}var A=window.cancelAnimationFrame;typeof A>"u"&&(typeof webkitCancelAnimationFrame<"u"?A=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?A=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?A=msCancelAnimationFrame:typeof A>"u"&&(A=function(r){clearTimeout(r)}));var oe=window.AudioContext;typeof oe>"u"&&(typeof webkitAudioContext<"u"&&(oe=webkitAudioContext),typeof mozAudioContext<"u"&&(oe=mozAudioContext));var D=window.URL;typeof D>"u"&&typeof webkitURL<"u"&&(D=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var ce=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),de=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,me=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),J=!de&&!ce&&!!navigator.webkitGetUserMedia||Ie()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,ue=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);ue&&!J&&navigator.userAgent.indexOf("CriOS")!==-1&&(ue=!1,J=!0);var Q=window.MediaStream;typeof Q>"u"&&typeof webkitMediaStream<"u"&&(Q=webkitMediaStream),typeof Q<"u"&&typeof Q.prototype.stop>"u"&&(Q.prototype.stop=function(){this.getTracks().forEach(function(r){r.stop()})});function xe(r){var e=1e3,t=["Bytes","KB","MB","GB","TB"];if(r===0)return"0 Bytes";var a=parseInt(Math.floor(Math.log(r)/Math.log(e)),10);return(r/Math.pow(e,a)).toPrecision(3)+" "+t[a]}function Fe(r,e){if(!r)throw"Blob object is required.";if(!r.type)try{r.type="video/webm"}catch{}var t=(r.type||"video/webm").split("/")[1];if(t.indexOf(";")!==-1&&(t=t.split(";")[0]),e&&e.indexOf(".")!==-1){var a=e.split(".");e=a[0],t=a[1]}var d=(e||Math.round(Math.random()*9999999999)+888888888)+"."+t;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(r,d);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(r,d);var s=document.createElement("a");s.href=D.createObjectURL(r),s.download=d,s.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(s),typeof s.click=="function"?s.click():(s.target="_blank",s.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),D.revokeObjectURL(s.href)}function Ie(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function M(r,e){return!r||!r.getTracks?[]:r.getTracks().filter(function(t){return t.kind===(e||"audio")})}function Pe(r,e){"srcObject"in e?e.srcObject=r:"mozSrcObject"in e?e.mozSrcObject=r:e.srcObject=r}function Ge(r,e){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var t=new EBML.Reader,a=new EBML.Decoder,d=EBML.tools,s=new FileReader;s.onload=function(f){var i=a.decode(this.result);i.forEach(function(g){t.read(g)}),t.stop();var h=d.makeMetadataSeekable(t.metadatas,t.duration,t.cues),b=this.result.slice(t.metadataSize),c=new Blob([h,b],{type:"video/webm"});e(c)},s.readAsArrayBuffer(r)}typeof y<"u"&&(y.invokeSaveAsDialog=Fe,y.getTracks=M,y.getSeekableBlob=Ge,y.bytesToSize=xe,y.isElectron=Ie);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var fe={};typeof oe<"u"?fe.AudioContext=oe:typeof webkitAudioContext<"u"&&(fe.AudioContext=webkitAudioContext),typeof y<"u"&&(y.Storage=fe);function ne(){if(me||ue||ce)return!0;var r=navigator.userAgent,e=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10),a,d;return(J||de)&&(a=r.indexOf("Chrome"),e=r.substring(a+7)),(d=e.indexOf(";"))!==-1&&(e=e.substring(0,d)),(d=e.indexOf(" "))!==-1&&(e=e.substring(0,d)),t=parseInt(""+e,10),isNaN(t)&&(e=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10)),t>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function G(r,e){var c=this;if(typeof r>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(e=e||{mimeType:"video/webm"},e.type==="audio"){if(M(r,"video").length&&M(r,"audio").length){var t;navigator.mozGetUserMedia?(t=new Q,t.addTrack(M(r,"audio")[0])):t=new Q(M(r,"audio")),r=t}(!e.mimeType||e.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(e.mimeType=J?"audio/webm":"audio/ogg"),e.mimeType&&e.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg")}var a=[];this.getArrayOfBlobs=function(){return a},this.record=function(){c.blob=null,c.clearRecordedData(),c.timestamps=[],b=[],a=[];var g=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",g),i&&(i=null),J&&!ne()&&(g="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&g.mimeType&&(MediaRecorder.isTypeSupported(g.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",g.mimeType),g.mimeType=e.type==="audio"?"audio/webm":"video/webm"));try{i=new MediaRecorder(r,g),e.mimeType=g.mimeType}catch{i=new MediaRecorder(r)}g.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in i&&i.canRecordMimeType(g.mimeType)===!1&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",g.mimeType)),i.ondataavailable=function(p){if(p.data&&b.push("ondataavailable: "+xe(p.data.size)),typeof e.timeSlice=="number"){if(p.data&&p.data.size&&(a.push(p.data),d(),typeof e.ondataavailable=="function")){var m=e.getNativeBlob?p.data:new Blob([p.data],{type:s(g)});e.ondataavailable(m)}return}if(!p.data||!p.data.size||p.data.size<100||c.blob){c.recordingCallback&&(c.recordingCallback(new Blob([],{type:s(g)})),c.recordingCallback=null);return}c.blob=e.getNativeBlob?p.data:new Blob([p.data],{type:s(g)}),c.recordingCallback&&(c.recordingCallback(c.blob),c.recordingCallback=null)},i.onstart=function(){b.push("started")},i.onpause=function(){b.push("paused")},i.onresume=function(){b.push("resumed")},i.onstop=function(){b.push("stopped")},i.onerror=function(p){p&&(p.name||(p.name="UnknownError"),b.push("error: "+p),e.disableLogs||(p.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",p):p.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",g.mimeType,") is not supported.",p):p.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",p):p.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",p):p.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",p):p.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",p):p.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",p):console.error("MediaRecorder Error",p)),function(m){if(!c.manuallyStopped&&i&&i.state==="inactive"){delete e.timeslice,i.start(10*60*1e3);return}setTimeout(m,1e3)}(),i.state!=="inactive"&&i.state!=="stopped"&&i.stop())},typeof e.timeSlice=="number"?(d(),i.start(e.timeSlice)):i.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[];function d(){c.timestamps.push(new Date().getTime()),typeof e.onTimeStamp=="function"&&e.onTimeStamp(c.timestamps[c.timestamps.length-1],c.timestamps)}function s(g){return i&&i.mimeType?i.mimeType:g.mimeType||"video/webm"}this.stop=function(g){g=g||function(){},c.manuallyStopped=!0,i&&(this.recordingCallback=g,i.state==="recording"&&i.stop(),typeof e.timeSlice=="number"&&setTimeout(function(){c.blob=new Blob(a,{type:s(e)}),c.recordingCallback(c.blob)},100))},this.pause=function(){i&&i.state==="recording"&&i.pause()},this.resume=function(){i&&i.state==="paused"&&i.resume()},this.clearRecordedData=function(){i&&i.state==="recording"&&c.stop(f),f()};function f(){a=[],i=null,c.timestamps=[]}var i;this.getInternalRecorder=function(){return i};function h(){if("active"in r){if(!r.active)return!1}else if("ended"in r&&r.ended)return!1;return!0}this.blob=null,this.getState=function(){return i&&i.state||"inactive"};var b=[];this.getAllStates=function(){return b},typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!1);var c=this;(function g(){if(!(!i||e.checkForInactiveTracks===!1)){if(h()===!1){e.disableLogs||console.log("MediaStream seems stopped."),c.stop();return}setTimeout(g,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MediaStreamRecorder=G);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function ve(r,e){if(!M(r,"audio").length)throw"Your stream has no audio tracks.";e=e||{};var t=this,a=[],d=[],s=!1,f=0,i,h=2,b=e.desiredSampRate;e.leftChannel===!0&&(h=1),e.numberOfAudioChannels===1&&(h=1),(!h||h<1)&&(h=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+h),typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!0);function c(){if(e.checkForInactiveTracks===!1)return!0;if("active"in r){if(!r.active)return!1}else if("ended"in r&&r.ended)return!1;return!0}this.record=function(){if(c()===!1)throw"Please make sure MediaStream is active.";C(),u=v=!1,s=!0,typeof e.timeSlice<"u"&&x()};function g(T,I){function P(B,he){var K=B.numberOfAudioChannels,N=B.leftBuffers.slice(0),te=B.rightBuffers.slice(0),q=B.sampleRate,re=B.internalInterleavedLength,Y=B.desiredSampRate;K===2&&(N=Ae(N,re),te=Ae(te,re),Y&&(N=pe(N,Y,q),te=pe(te,Y,q))),K===1&&(N=Ae(N,re),Y&&(N=pe(N,Y,q))),Y&&(q=Y);function pe(U,Z,H){var _=Math.round(U.length*(Z/H)),O=[],ie=Number((U.length-1)/(_-1));O[0]=U[0];for(var ae=1;ae<_-1;ae++){var Be=ae*ie,ze=Number(Math.floor(Be)).toFixed(),Je=Number(Math.ceil(Be)).toFixed(),Qe=Be-ze;O[ae]=He(U[ze],U[Je],Qe)}return O[_-1]=U[U.length-1],O}function He(U,Z,H){return U+(Z-U)*H}function Ae(U,Z){for(var H=new Float64Array(Z),_=0,O=U.length,ie=0;ie<O;ie++){var ae=U[ie];H.set(ae,_),_+=ae.length}return H}function _e(U,Z){for(var H=U.length+Z.length,_=new Float64Array(H),O=0,ie=0;ie<H;)_[ie++]=U[O],_[ie++]=Z[O],O++;return _}function ye(U,Z,H){for(var _=H.length,O=0;O<_;O++)U.setUint8(Z+O,H.charCodeAt(O))}var Re;K===2&&(Re=_e(N,te)),K===1&&(Re=N);var Ce=Re.length,$e=44+Ce*2,Me=new ArrayBuffer($e),E=new DataView(Me);ye(E,0,"RIFF"),E.setUint32(4,36+Ce*2,!0),ye(E,8,"WAVE"),ye(E,12,"fmt "),E.setUint32(16,16,!0),E.setUint16(20,1,!0),E.setUint16(22,K,!0),E.setUint32(24,q,!0),E.setUint32(28,q*K*2,!0),E.setUint16(32,K*2,!0),E.setUint16(34,16,!0),ye(E,36,"data"),E.setUint32(40,Ce*2,!0);for(var Ke=Ce,je=44,Ye=1,De=0;De<Ke;De++)E.setInt16(je,Re[De]*(32767*Ye),!0),je+=2;if(he)return he({buffer:Me,view:E});postMessage({buffer:Me,view:E})}if(T.noWorker){P(T,function(B){I(B.buffer,B.view)});return}var ee=p(P);ee.onmessage=function(B){I(B.data.buffer,B.data.view),D.revokeObjectURL(ee.workerURL),ee.terminate()},ee.postMessage(T)}function p(T){var I=D.createObjectURL(new Blob([T.toString(),";this.onmessage =  function (eee) {"+T.name+"(eee.data);}"],{type:"application/javascript"})),P=new Worker(I);return P.workerURL=I,P}this.stop=function(T){T=T||function(){},s=!1,g({desiredSampRate:b,sampleRate:n,numberOfAudioChannels:h,internalInterleavedLength:f,leftBuffers:a,rightBuffers:h===1?[]:d,noWorker:e.noWorker},function(I,P){t.blob=new Blob([P],{type:"audio/wav"}),t.buffer=new ArrayBuffer(P.buffer.byteLength),t.view=P,t.sampleRate=b||n,t.bufferSize=k,t.length=f,u=!1,T&&T(t.blob)})},typeof y.Storage>"u"&&(y.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!y.Storage.AudioContextConstructor||y.Storage.AudioContextConstructor.state==="closed")&&(y.Storage.AudioContextConstructor=new y.Storage.AudioContext);var m=y.Storage.AudioContextConstructor,l=m.createMediaStreamSource(r),S=[0,256,512,1024,2048,4096,8192,16384],k=typeof e.bufferSize>"u"?4096:e.bufferSize;if(S.indexOf(k)===-1&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(S,null,"	"))),m.createJavaScriptNode)i=m.createJavaScriptNode(k,h,h);else if(m.createScriptProcessor)i=m.createScriptProcessor(k,h,h);else throw"WebAudio API has no support on this browser.";l.connect(i),e.bufferSize||(k=i.bufferSize);var n=typeof e.sampleRate<"u"?e.sampleRate:m.sampleRate||44100;(n<22050||n>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var v=!1;this.pause=function(){v=!0},this.resume=function(){if(c()===!1)throw"Please make sure MediaStream is active.";if(!s){e.disableLogs||console.log("Seems recording has been restarted."),this.record();return}v=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,s&&this.stop(o),o()};function C(){a=[],d=[],f=0,u=!1,s=!1,v=!1,m=null,t.leftchannel=a,t.rightchannel=d,t.numberOfAudioChannels=h,t.desiredSampRate=b,t.sampleRate=n,t.recordingLength=f,R={left:[],right:[],recordingLength:0}}function o(){i&&(i.onaudioprocess=null,i.disconnect(),i=null),l&&(l.disconnect(),l=null),C()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var u=!1;function w(T){if(!v){if(c()===!1&&(e.disableLogs||console.log("MediaStream seems stopped."),i.disconnect(),s=!1),!s){l&&(l.disconnect(),l=null);return}u||(u=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var I=T.inputBuffer.getChannelData(0),P=new Float32Array(I);if(a.push(P),h===2){var ee=T.inputBuffer.getChannelData(1),B=new Float32Array(ee);d.push(B)}f+=k,t.recordingLength=f,typeof e.timeSlice<"u"&&(R.recordingLength+=k,R.left.push(P),h===2&&R.right.push(B))}}i.onaudioprocess=w,m.createMediaStreamDestination?i.connect(m.createMediaStreamDestination()):i.connect(m.destination),this.leftchannel=a,this.rightchannel=d,this.numberOfAudioChannels=h,this.desiredSampRate=b,this.sampleRate=n,t.recordingLength=f;var R={left:[],right:[],recordingLength:0};function x(){!s||typeof e.ondataavailable!="function"||typeof e.timeSlice>"u"||(R.left.length?(g({desiredSampRate:b,sampleRate:n,numberOfAudioChannels:h,internalInterleavedLength:R.recordingLength,leftBuffers:R.left,rightBuffers:h===1?[]:R.right},function(T,I){var P=new Blob([I],{type:"audio/wav"});e.ondataavailable(P),setTimeout(x,e.timeSlice)}),R={left:[],right:[],recordingLength:0}):setTimeout(x,e.timeSlice))}}typeof y<"u"&&(y.StereoAudioRecorder=ve);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function ge(r,e){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";e=e||{},e.frameInterval||(e.frameInterval=10);var t=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(S){S in document.createElement("canvas")&&(t=!0)});var a=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,d=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);a&&s&&s[2]&&(d=parseInt(s[2],10)),a&&d<52&&(t=!1),e.useWhammyRecorder&&(t=!1);var f,i;if(t)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),r instanceof HTMLCanvasElement)f=r;else if(r instanceof CanvasRenderingContext2D)f=r.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var h;this.record=function(){if(h=!0,t&&!e.useWhammyRecorder){var S;"captureStream"in f?S=f.captureStream(25):"mozCaptureStream"in f?S=f.mozCaptureStream(25):"webkitCaptureStream"in f&&(S=f.webkitCaptureStream(25));try{var k=new Q;k.addTrack(M(S,"video")[0]),S=k}catch{}if(!S)throw"captureStream API are NOT available.";i=new G(S,{mimeType:e.mimeType||"video/webm"}),i.record()}else l.frames=[],m=new Date().getTime(),p();e.initCallback&&e.initCallback()},this.getWebPImages=function(S){if(r.nodeName.toLowerCase()!=="canvas"){S();return}var k=l.frames.length;l.frames.forEach(function(n,v){var C=k-v;e.disableLogs||console.log(C+"/"+k+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(C,k);var o=n.image.toDataURL("image/webp",1);l.frames[v].image=o}),e.disableLogs||console.log("Generating WebM"),S()},this.stop=function(S){h=!1;var k=this;if(t&&i){i.stop(S);return}this.getWebPImages(function(){l.compile(function(n){e.disableLogs||console.log("Recording finished!"),k.blob=n,k.blob.forEach&&(k.blob=new Blob([],{type:"video/webm"})),S&&S(k.blob),l.frames=[]})})};var b=!1;this.pause=function(){if(b=!0,i instanceof G){i.pause();return}},this.resume=function(){if(b=!1,i instanceof G){i.resume();return}h||this.record()},this.clearRecordedData=function(){h&&this.stop(c),c()};function c(){l.frames=[],h=!1,b=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function g(){var S=document.createElement("canvas"),k=S.getContext("2d");return S.width=r.width,S.height=r.height,k.drawImage(r,0,0),S}function p(){if(b)return m=new Date().getTime(),setTimeout(p,500);if(r.nodeName.toLowerCase()==="canvas"){var S=new Date().getTime()-m;m=new Date().getTime(),l.frames.push({image:g(),duration:S}),h&&setTimeout(p,e.frameInterval);return}html2canvas(r,{grabMouse:typeof e.showMousePointer>"u"||e.showMousePointer,onrendered:function(k){var n=new Date().getTime()-m;if(!n)return setTimeout(p,e.frameInterval);m=new Date().getTime(),l.frames.push({image:k.toDataURL("image/webp",1),duration:n}),h&&setTimeout(p,e.frameInterval)}})}var m=new Date().getTime(),l=new Le.Video(100)}typeof y<"u"&&(y.CanvasRecorder=ge);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function be(r,e){e=e||{},e.frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),h.width=e.canvas.width||320,h.height=e.canvas.height||240,b=h.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(c=e.video.cloneNode(),e.initCallback&&e.initCallback()):(c=document.createElement("video"),Pe(r,c),c.onloadedmetadata=function(){e.initCallback&&e.initCallback()},c.width=e.video.width,c.height=e.video.height),c.muted=!0,c.play(),g=new Date().getTime(),p=new Le.Video,e.disableLogs||(console.log("canvas resolutions",h.width,"*",h.height),console.log("video width/height",c.width||h.width,"*",c.height||h.height)),t(e.frameInterval)};function t(m){m=typeof m<"u"?m:10;var l=new Date().getTime()-g;if(!l)return setTimeout(t,m,m);if(f)return g=new Date().getTime(),setTimeout(t,100);g=new Date().getTime(),c.paused&&c.play(),b.drawImage(c,0,0,h.width,h.height),p.frames.push({duration:l,image:h.toDataURL("image/webp")}),s||setTimeout(t,m,m)}function a(m){var l=-1,S=m.length;(function k(){if(l++,l===S){m.callback();return}setTimeout(function(){m.functionToLoop(k,l)},1)})()}function d(m,l,S,k,n){var v=document.createElement("canvas");v.width=h.width,v.height=h.height;var C=v.getContext("2d"),o=[],u=m.length,w={r:0,g:0,b:0},R=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),x=0,T=0,I=!1;a({length:u,functionToLoop:function(P,ee){var B,he,K,N=function(){!I&&K-B<=K*T||(I=!0,o.push(m[ee])),P()};if(I)N();else{var te=new Image;te.onload=function(){C.drawImage(te,0,0,h.width,h.height);var q=C.getImageData(0,0,h.width,h.height);B=0,he=q.data.length,K=q.data.length/4;for(var re=0;re<he;re+=4){var Y={r:q.data[re],g:q.data[re+1],b:q.data[re+2]},pe=Math.sqrt(Math.pow(Y.r-w.r,2)+Math.pow(Y.g-w.g,2)+Math.pow(Y.b-w.b,2));pe<=R*x&&B++}N()},te.src=m[ee].image}},callback:function(){o=o.concat(m.slice(u)),o.length<=0&&o.push(m[m.length-1]),n(o)}})}var s=!1;this.stop=function(m){m=m||function(){},s=!0;var l=this;setTimeout(function(){d(p.frames,-1,null,null,function(S){p.frames=S,e.advertisement&&e.advertisement.length&&(p.frames=e.advertisement.concat(p.frames)),p.compile(function(k){l.blob=k,l.blob.forEach&&(l.blob=new Blob([],{type:"video/webm"})),m&&m(l.blob)})})},10)};var f=!1;this.pause=function(){f=!0},this.resume=function(){f=!1,s&&this.record()},this.clearRecordedData=function(){s||this.stop(i),i()};function i(){p.frames=[],s=!0,f=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var h=document.createElement("canvas"),b=h.getContext("2d"),c,g,p}typeof y<"u"&&(y.WhammyRecorder=be);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Le=function(){function r(a){this.frames=[],this.duration=a||1,this.quality=.8}r.prototype.add=function(a,d){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:d||this.duration})};function e(a){var d=D.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (eee) {"+a.name+"(eee.data);}"],{type:"application/javascript"})),s=new Worker(d);return D.revokeObjectURL(d),s}function t(a){function d(n){var v=f(n);if(!v)return[];for(var C=3e4,o=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:S(v.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:v.width,id:176},{data:v.height,id:186}]}]}]}]}],u=0,w=0;u<n.length;){var R=[],x=0;do R.push(n[u]),x+=n[u].duration,u++;while(u<n.length&&x<C);var T=0,I={id:524531317,data:s(w,T,R)};o[1].data.push(I),w+=x}return c(o)}function s(n,v,C){return[{data:n,id:231}].concat(C.map(function(o){var u=g({frame:o.data.slice(4),trackNum:1,timecode:Math.round(v)});return v+=o.duration,{data:u,id:163}}))}function f(n){if(!n[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var v=n[0].width,C=n[0].height,o=n[0].duration,u=1;u<n.length;u++)o+=n[u].duration;return{duration:o,width:v,height:C}}function i(n){for(var v=[];n>0;)v.push(n&255),n=n>>8;return new Uint8Array(v.reverse())}function h(n){return new Uint8Array(n.split("").map(function(v){return v.charCodeAt(0)}))}function b(n){var v=[],C=n.length%8?new Array(9-n.length%8).join("0"):"";n=C+n;for(var o=0;o<n.length;o+=8)v.push(parseInt(n.substr(o,8),2));return new Uint8Array(v)}function c(n){for(var v=[],C=0;C<n.length;C++){var o=n[C].data;typeof o=="object"&&(o=c(o)),typeof o=="number"&&(o=b(o.toString(2))),typeof o=="string"&&(o=h(o));var u=o.size||o.byteLength||o.length,w=Math.ceil(Math.ceil(Math.log(u)/Math.log(2))/8),R=u.toString(2),x=new Array(w*7+7+1-R.length).join("0")+R,T=new Array(w).join("0")+"1"+x;v.push(i(n[C].id)),v.push(b(T)),v.push(o)}return new Blob(v,{type:"video/webm"})}function g(n){var v=0;v|=128;var C=[n.trackNum|128,n.timecode>>8,n.timecode&255,v].map(function(o){return String.fromCharCode(o)}).join("")+n.frame;return C}function p(n){for(var v=n.RIFF[0].WEBP[0],C=v.indexOf("¬ù*"),o=0,u=[];o<4;o++)u[o]=v.charCodeAt(C+3+o);var w,R,x;return x=u[1]<<8|u[0],w=x&16383,x=u[3]<<8|u[2],R=x&16383,{width:w,height:R,data:v,riff:n}}function m(n,v){return parseInt(n.substr(v+4,4).split("").map(function(C){var o=C.charCodeAt(0).toString(2);return new Array(8-o.length+1).join("0")+o}).join(""),2)}function l(n){for(var v=0,C={};v<n.length;){var o=n.substr(v,4),u=m(n,v),w=n.substr(v+4+4,u);v+=8+u,C[o]=C[o]||[],o==="RIFF"||o==="LIST"?C[o].push(l(w)):C[o].push(w)}return C}function S(n){return[].slice.call(new Uint8Array(new Float64Array([n]).buffer),0).map(function(v){return String.fromCharCode(v)}).reverse().join("")}var k=new d(a.map(function(n){var v=p(l(atob(n.image.slice(23))));return v.duration=n.duration,v}));postMessage(k)}return r.prototype.compile=function(a){var d=e(t);d.onmessage=function(s){if(s.data.error){console.error(s.data.error);return}a(s.data)},d.postMessage(this.frames)},{Video:r}}();typeof y<"u"&&(y.Whammy=Le);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var X={init:function(){var r=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var e=1,t=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),a,d=indexedDB.open(t,e);function s(i){i.createObjectStore(r.dataStoreName)}function f(){var i=a.transaction([r.dataStoreName],"readwrite");r.videoBlob&&i.objectStore(r.dataStoreName).put(r.videoBlob,"videoBlob"),r.gifBlob&&i.objectStore(r.dataStoreName).put(r.gifBlob,"gifBlob"),r.audioBlob&&i.objectStore(r.dataStoreName).put(r.audioBlob,"audioBlob");function h(b){i.objectStore(r.dataStoreName).get(b).onsuccess=function(c){r.callback&&r.callback(c.target.result,b)}}h("audioBlob"),h("videoBlob"),h("gifBlob")}d.onerror=r.onError,d.onsuccess=function(){if(a=d.result,a.onerror=r.onError,a.setVersion)if(a.version!==e){var i=a.setVersion(e);i.onsuccess=function(){s(a),f()}}else f();else f()},d.onupgradeneeded=function(i){s(i.target.result)}},Fetch:function(r){return this.callback=r,this.init(),this},Store:function(r){return this.audioBlob=r.audioBlob,this.videoBlob=r.videoBlob,this.gifBlob=r.gifBlob,this.init(),this},onError:function(r){console.error(JSON.stringify(r,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof y<"u"&&(y.DiskStorage=X);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function we(r,e){if(typeof GIFEncoder>"u"){var t=document.createElement("script");t.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(t)}e=e||{};var a=r instanceof CanvasRenderingContext2D||r instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(m.record,1e3);return}if(!h){setTimeout(m.record,1e3);return}a||(e.width||(e.width=b.offsetWidth||320),e.height||(e.height=b.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),f.width=e.canvas.width||320,f.height=e.canvas.height||240,b.width=e.video.width||320,b.height=e.video.height||240),p=new GIFEncoder,p.setRepeat(0),p.setDelay(e.frameRate||200),p.setQuality(e.quality||10),p.start(),typeof e.onGifRecordingStarted=="function"&&e.onGifRecordingStarted();function l(S){if(m.clearedRecordedData!==!0){if(d)return setTimeout(function(){l(S)},100);c=$(l),typeof g===void 0&&(g=S),!(S-g<90)&&(!a&&b.paused&&b.play(),a||i.drawImage(b,0,0,f.width,f.height),e.onGifPreview&&e.onGifPreview(f.toDataURL("image/png")),p.addFrame(i),g=S)}}c=$(l),e.initCallback&&e.initCallback()},this.stop=function(l){l=l||function(){},c&&A(c),this.blob=new Blob([new Uint8Array(p.stream().bin)],{type:"image/gif"}),l(this.blob),p.stream().bin=[]};var d=!1;this.pause=function(){d=!0},this.resume=function(){d=!1},this.clearRecordedData=function(){m.clearedRecordedData=!0,s()};function s(){p&&(p.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var f=document.createElement("canvas"),i=f.getContext("2d");a&&(r instanceof CanvasRenderingContext2D?(i=r,f=i.canvas):r instanceof HTMLCanvasElement&&(i=r.getContext("2d"),f=r));var h=!0;if(!a){var b=document.createElement("video");b.muted=!0,b.autoplay=!0,b.playsInline=!0,h=!1,b.onloadedmetadata=function(){h=!0},Pe(r,b),b.play()}var c=null,g,p,m=this}typeof y<"u"&&(y.GifRecorder=we);function Ee(r,e){var t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(o){typeof y<"u"||o&&(typeof window<"u"||typeof L>"u"||(L.navigator={userAgent:t,getUserMedia:function(){}},L.console||(L.console={}),(typeof L.console.log>"u"||typeof L.console.error>"u")&&(L.console.error=L.console.log=L.console.log||function(){console.log(arguments)}),typeof document>"u"&&(o.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var u={getContext:function(){return u},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return u},o.HTMLVideoElement=function(){}),typeof location>"u"&&(o.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(o.screen={width:0,height:0}),typeof b>"u"&&(o.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),o.window=L))})(typeof L<"u"?L:null),e=e||"multi-streams-mixer";var a=[],d=!1,s=document.createElement("canvas"),f=s.getContext("2d");s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=e,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var i=this,h=window.AudioContext;typeof h>"u"&&(typeof webkitAudioContext<"u"&&(h=webkitAudioContext),typeof mozAudioContext<"u"&&(h=mozAudioContext));var b=window.URL;typeof b>"u"&&typeof webkitURL<"u"&&(b=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var c=window.MediaStream;typeof c>"u"&&typeof webkitMediaStream<"u"&&(c=webkitMediaStream),typeof c<"u"&&typeof c.prototype.stop>"u"&&(c.prototype.stop=function(){this.getTracks().forEach(function(o){o.stop()})});var g={};typeof h<"u"?g.AudioContext=h:typeof webkitAudioContext<"u"&&(g.AudioContext=webkitAudioContext);function p(o,u){"srcObject"in u?u.srcObject=o:"mozSrcObject"in u?u.mozSrcObject=o:u.srcObject=o}this.startDrawingFrames=function(){m()};function m(){if(!d){var o=a.length,u=!1,w=[];if(a.forEach(function(x){x.stream||(x.stream={}),x.stream.fullcanvas?u=x:w.push(x)}),u)s.width=u.stream.width,s.height=u.stream.height;else if(w.length){s.width=o>1?w[0].width*2:w[0].width;var R=1;(o===3||o===4)&&(R=2),(o===5||o===6)&&(R=3),(o===7||o===8)&&(R=4),(o===9||o===10)&&(R=5),s.height=w[0].height*R}else s.width=i.width||360,s.height=i.height||240;u&&u instanceof HTMLVideoElement&&l(u),w.forEach(function(x,T){l(x,T)}),setTimeout(m,i.frameInterval)}}function l(o,u){if(!d){var w=0,R=0,x=o.width,T=o.height;u===1&&(w=o.width),u===2&&(R=o.height),u===3&&(w=o.width,R=o.height),u===4&&(R=o.height*2),u===5&&(w=o.width,R=o.height*2),u===6&&(R=o.height*3),u===7&&(w=o.width,R=o.height*3),typeof o.stream.left<"u"&&(w=o.stream.left),typeof o.stream.top<"u"&&(R=o.stream.top),typeof o.stream.width<"u"&&(x=o.stream.width),typeof o.stream.height<"u"&&(T=o.stream.height),f.drawImage(o,w,R,x,T),typeof o.stream.onRender=="function"&&o.stream.onRender(f,w,R,x,T,u)}}function S(){d=!1;var o=k(),u=n();return u&&u.getTracks().filter(function(w){return w.kind==="audio"}).forEach(function(w){o.addTrack(w)}),r.forEach(function(w){w.fullcanvas}),o}function k(){C();var o;"captureStream"in s?o=s.captureStream():"mozCaptureStream"in s?o=s.mozCaptureStream():i.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var u=new c;return o.getTracks().filter(function(w){return w.kind==="video"}).forEach(function(w){u.addTrack(w)}),s.stream=u,u}function n(){g.AudioContextConstructor||(g.AudioContextConstructor=new g.AudioContext),i.audioContext=g.AudioContextConstructor,i.audioSources=[],i.useGainNode===!0&&(i.gainNode=i.audioContext.createGain(),i.gainNode.connect(i.audioContext.destination),i.gainNode.gain.value=0);var o=0;if(r.forEach(function(u){if(u.getTracks().filter(function(R){return R.kind==="audio"}).length){o++;var w=i.audioContext.createMediaStreamSource(u);i.useGainNode===!0&&w.connect(i.gainNode),i.audioSources.push(w)}}),!!o)return i.audioDestination=i.audioContext.createMediaStreamDestination(),i.audioSources.forEach(function(u){u.connect(i.audioDestination)}),i.audioDestination.stream}function v(o){var u=document.createElement("video");return p(o,u),u.className=e,u.muted=!0,u.volume=0,u.width=o.width||i.width||360,u.height=o.height||i.height||240,u.play(),u}this.appendStreams=function(o){if(!o)throw"First parameter is required.";o instanceof Array||(o=[o]),o.forEach(function(u){var w=new c;if(u.getTracks().filter(function(T){return T.kind==="video"}).length){var R=v(u);R.stream=u,a.push(R),w.addTrack(u.getTracks().filter(function(T){return T.kind==="video"})[0])}if(u.getTracks().filter(function(T){return T.kind==="audio"}).length){var x=i.audioContext.createMediaStreamSource(u);i.audioDestination=i.audioContext.createMediaStreamDestination(),x.connect(i.audioDestination),w.addTrack(i.audioDestination.stream.getTracks().filter(function(T){return T.kind==="audio"})[0])}r.push(w)})},this.releaseStreams=function(){a=[],d=!0,i.gainNode&&(i.gainNode.disconnect(),i.gainNode=null),i.audioSources.length&&(i.audioSources.forEach(function(o){o.disconnect()}),i.audioSources=[]),i.audioDestination&&(i.audioDestination.disconnect(),i.audioDestination=null),i.audioContext&&i.audioContext.close(),i.audioContext=null,f.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(o){o&&!(o instanceof Array)&&(o=[o]),C(o)};function C(o){a=[],o=o||r,o.forEach(function(u){if(u.getTracks().filter(function(R){return R.kind==="video"}).length){var w=v(u);w.stream=u,a.push(w)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=S}typeof y>"u"&&(F.exports=Ee);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function Oe(r,e){r=r||[];var t=this,a,d;e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},e.frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){a=new Ee(r,e.elementClass||"multi-streams-mixer"),s().length&&(a.frameInterval=e.frameInterval||10,a.width=e.video.width||360,a.height=e.video.height||240,a.startDrawingFrames()),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(a.getMixedStream()),d=new G(a.getMixedStream(),e),d.record()};function s(){var f=[];return r.forEach(function(i){M(i,"video").forEach(function(h){f.push(h)})}),f}this.stop=function(f){d&&d.stop(function(i){t.blob=i,f(i),t.clearRecordedData()})},this.pause=function(){d&&d.pause()},this.resume=function(){d&&d.resume()},this.clearRecordedData=function(){d&&(d.clearRecordedData(),d=null),a&&(a.releaseStreams(),a=null)},this.addStreams=function(f){if(!f)throw"First parameter is required.";f instanceof Array||(f=[f]),r.concat(f),!(!d||!a)&&(a.appendStreams(f),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(a.getMixedStream()))},this.resetVideoStreams=function(f){a&&(f&&!(f instanceof Array)&&(f=[f]),a.resetVideoStreams(f))},this.getMixer=function(){return a},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MultiStreamRecorder=Oe);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function qe(r,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof r>"u")throw'First argument "MediaStream" is required.';var t=this;t.recordRTC=new y(r,e),this.startRecording=function(){return new Promise(function(a,d){try{t.recordRTC.startRecording(),a()}catch(s){d(s)}})},this.stopRecording=function(){return new Promise(function(a,d){try{t.recordRTC.stopRecording(function(s){if(t.blob=t.recordRTC.getBlob(),!t.blob||!t.blob.size){d("Empty blob.",t.blob);return}a(s)})}catch(s){d(s)}})},this.pauseRecording=function(){return new Promise(function(a,d){try{t.recordRTC.pauseRecording(),a()}catch(s){d(s)}})},this.resumeRecording=function(){return new Promise(function(a,d){try{t.recordRTC.resumeRecording(),a()}catch(s){d(s)}})},this.getDataURL=function(a){return new Promise(function(d,s){try{t.recordRTC.getDataURL(function(f){d(f)})}catch(f){s(f)}})},this.getBlob=function(){return new Promise(function(a,d){try{a(t.recordRTC.getBlob())}catch(s){d(s)}})},this.getInternalRecorder=function(){return new Promise(function(a,d){try{a(t.recordRTC.getInternalRecorder())}catch(s){d(s)}})},this.reset=function(){return new Promise(function(a,d){try{a(t.recordRTC.reset())}catch(s){d(s)}})},this.destroy=function(){return new Promise(function(a,d){try{a(t.recordRTC.destroy())}catch(s){d(s)}})},this.getState=function(){return new Promise(function(a,d){try{a(t.recordRTC.getState())}catch(s){d(s)}})},this.blob=null,this.version="5.6.2"}typeof y<"u"&&(y.RecordRTCPromisesHandler=qe);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function le(r,e){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),e=e||{},e.width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0;var t;function a(){return new ReadableStream({start:function(b){var c=document.createElement("canvas"),g=document.createElement("video"),p=!0;g.srcObject=r,g.muted=!0,g.height=e.height,g.width=e.width,g.volume=0,g.onplaying=function(){c.width=e.width,c.height=e.height;var m=c.getContext("2d"),l=1e3/e.frameRate,S=setInterval(function(){if(t&&(clearInterval(S),b.close()),p&&(p=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),m.drawImage(g,0,0),b._controlledReadableStream.state!=="closed")try{b.enqueue(m.getImageData(0,0,e.width,e.height))}catch{}},l)},g.play()}})}var d;function s(b,c){if(!e.workerPath&&!c){t=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(p){p.arrayBuffer().then(function(m){s(b,m)})});return}if(!e.workerPath&&c instanceof ArrayBuffer){var g=new Blob([c],{type:"text/javascript"});e.workerPath=D.createObjectURL(g)}e.workerPath||console.error("workerPath parameter is missing."),d=new Worker(e.workerPath),d.postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),d.addEventListener("message",function(p){p.data==="READY"?(d.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),a().pipeTo(new WritableStream({write:function(m){if(t){console.error("Got image, but recorder is finished!");return}d.postMessage(m.data.buffer,[m.data.buffer])}}))):p.data&&(f||h.push(p.data))})}this.record=function(){h=[],f=!1,this.blob=null,s(r),typeof e.initCallback=="function"&&e.initCallback()};var f;this.pause=function(){f=!0},this.resume=function(){f=!1};function i(b){if(!d){b&&b();return}d.addEventListener("message",function(c){c.data===null&&(d.terminate(),d=null,b&&b())}),d.postMessage(null)}var h=[];this.stop=function(b){t=!0;var c=this;i(function(){c.blob=new Blob(h,{type:"video/webm"}),b(c.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){h=[],f=!1,this.blob=null},this.blob=null}typeof y<"u"&&(y.WebAssemblyRecorder=le)})(Ve);var ut=Ve.exports;const ft=Ze(ut),ct=it({emits:["uploaded","close"],setup:function(F,y){const se=st(null),j={audioStream:null,recorderRTC:null,audioVisualizer:null},z=dt({recordingTime:{seconds:0,milliseconds:0},recorderTimerInterval:null,isRecording:!1});return{startRecording:async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}).then(W=>{j.audioStream=W,j.recorderRTC=new ft(W,{type:"audio",mimeType:"audio/webm",timeSlice:1e3,disableLogs:!1}),j.recorderRTC.startRecording(),z.isRecording=!0,z.recorderTimerInterval=setInterval(()=>{z.recordingTime.milliseconds+=1,z.recordingTime.milliseconds>=99&&(z.recordingTime.milliseconds=0,z.recordingTime.seconds+=1)},1e3/100);let A=new(window.AudioContext||window.webkitAudioContext);j.audioVisualizer=Xe().setCanvas(se.value).setAudioElement({context:A,source:A.createMediaStreamSource(W)}),j.audioVisualizer.linesWaveStart()})}catch(W){toastError(W.message)}},stopRecording:async()=>{try{await j.recorderRTC.stopRecording(()=>{const W=j.recorderRTC.getBlob();z.isRecording=!1;const A=new Date,oe=String(A.getDate()).padStart(2,"0"),D=String(A.getMonth()+1).padStart(2,"0"),ce=A.getFullYear(),de=String(A.getHours()).padStart(2,"0"),me=String(A.getMinutes()).padStart(2,"0");let J=`AUDREC-${ce}${D}${oe}-${de}${me}.webm`;y.emit("uploaded",new File([W],J,{type:"audio/webm"})),j.audioStream.getTracks().forEach(ue=>{ue.stop()}),j.audioStream=null,j.recorderRTC=null,j.audioVisualizer=null,clearInterval(z.recorderTimerInterval)})}catch(W){toastError(W.message)}},recorderState:z,waveformCanvas:se}},components:{PopupPanel:tt,PrimaryTextButton:et}}),lt={class:"popup-card"},ht={class:"py-5"},pt={class:"px-4 pb-1.5"},mt={class:"text-lab-pr2 text-par-m font-medium"},vt={class:"px-4 py-6"},gt={ref:"waveformCanvas",id:"waveform",class:"w-full h-6"},bt={class:""},wt={class:"mb-8"},yt={class:"text-lab-pr2 text-title-1 text-center mb-2"},Rt={class:"text-center"},Ct={class:"text-lab-sc text-par-l"},St={class:"flex justify-center mb-8"},Tt={class:"inline-flex-center size-12 bg-transparent ring-2 ring-fill-pr overflow-hidden outline-hidden rounded-full"},kt={key:0,class:"flex justify-center"};function xt(F,y,se,j,z,ke){const $=We("PrimaryTextButton"),W=We("PopupPanel");return Te(),Se("div",lt,[Ne(W,null,{default:ot(()=>[V("div",ht,[V("div",pt,[V("h3",mt,Ue(F.$t("editor.recording_audio")),1)]),V("div",vt,[V("div",{class:nt(["border-b-2",[F.recorderState.isRecording?"border-brand-900":"border-fill-pr"]])},[V("canvas",gt,null,512)],2)]),V("div",bt,[V("div",wt,[V("h4",yt,Ue(F.$filters.formatTime(F.recorderState.recordingTime.seconds)),1),V("p",Rt,[V("span",Ct,Ue(F.recorderState.recordingTime.milliseconds.toString().toString().padStart(2,"0")),1)])]),V("div",St,[V("div",Tt,[F.recorderState.isRecording?(Te(),Se("button",{key:0,onClick:y[0]||(y[0]=(...A)=>F.stopRecording&&F.stopRecording(...A)),type:"button",class:"inline-block outline-none cursor-pointer size-4 rounded-xs bg-red-600"})):(Te(),Se("button",{key:1,onClick:y[1]||(y[1]=(...A)=>F.startRecording&&F.startRecording(...A)),type:"button",class:"inline-block outline-none size-full bg-red-600 cursor-pointer"}))])]),F.recorderState.isRecording?at("",!0):(Te(),Se("div",kt,[Ne($,{buttonRole:"marginal",onClick:y[2]||(y[2]=A=>F.$emit("close")),buttonText:F.$t("labels.cancel")},null,8,["buttonText"])]))])])]),_:1})])}const Ft=rt(ct,[["render",xt]]);export{Ft as default};
