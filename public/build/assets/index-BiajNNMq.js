let P;const z=new Uint8Array(16);function Q(){if(!P&&(P=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!P))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return P(z)}const n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function L(e,t=0){return n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]}const K=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),A={randomUUID:K};function V(e,t,r){if(A.randomUUID&&!e)return A.randomUUID();e=e||{};const i=e.random||(e.rng||Q)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,L(i)}typeof window<"u"&&typeof location<"u"&&location.search.indexOf("giphy-debug");var h="",k=16,C=()=>{let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=t.length;for(let i=0;i<k;i++)e+=t.charAt(Math.floor(Math.random()*r));return e},Y=()=>{if(!h){try{h=sessionStorage.getItem("giphyPingbackId")}catch{}if(!h){const e=new Date().getTime().toString(16);try{h=`${e}${V().replace(/-/g,"")}`.substring(0,k)}catch{h=C()}try{sessionStorage.setItem("giphyPingbackId",h)}catch{}}}return h},B=Y,w=null;new Promise(e=>{typeof Image>"u"&&e(!1);const t=new Image;t.onload=()=>{w=!0,e(w)},t.onerror=()=>{w=!1,e(w)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"});var v=(typeof window<"u"?window:global)||{};v._GIPHY_SDK_HEADERS_=v._GIPHY_SDK_HEADERS_||(v.Headers?new v.Headers({"X-GIPHY-SDK-PLATFORM":"web"}):void 0);var G=()=>v._GIPHY_SDK_HEADERS_,E=(e,t)=>{var r;return(r=G())==null?void 0:r.set(e,t)},F=Object.defineProperty,M=Object.defineProperties,N=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertyNames,$=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,D=(e,t,r)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))J.call(t,r)&&D(e,r,t[r]);if($)for(var r of $(t))W.call(t,r)&&D(e,r,t[r]);return e},b=(e,t)=>M(e,N(t)),Z=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),ee=(e,t)=>function(){return t||(0,e[X(e)[0]])((t={exports:{}}).exports,t),t.exports},te=(e,t,r)=>new Promise((i,a)=>{var p=c=>{try{_(r.next(c))}catch(m){a(m)}},f=c=>{try{_(r.throw(c))}catch(m){a(m)}},_=c=>c.done?i(c.value):Promise.resolve(c.value).then(p,f);_((r=r.apply(e,t)).next())}),re=ee({"package.json"(e,t){t.exports={scripts:{lint:"run -T eslint . --ext .ts,.tsx",clean:"rm -rf ./dist",dev:"parcel public/test.html",docs:"typedoc src/index.ts",build:"run -T tsup src/index.ts --format cjs,esm --dts && run -T publint",prepublish:"npm run clean && npm run build",test:"run -T jest --config ./jestconfig.js","test:watch":"run -T jest --config ./jestconfig.js --watchAll"},name:"@giphy/js-fetch-api",version:"5.6.0",description:"Javascript API to fetch gifs and stickers from the GIPHY API.",homepage:"https://github.com/Giphy/giphy-js/tree/master/packages/fetch-api",main:"dist/index.cjs",types:"dist/index.d.ts",module:"dist/index.js",type:"module",sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/index.js",require:"./dist/index.cjs"},"./package.json":"./package.json"},files:["dist/","src/**/*"],license:"MIT",publishConfig:{access:"public"},dependencies:{"@giphy/js-types":"*","@giphy/js-util":"*"},devDependencies:{"jest-fetch-mock":"^3.0.3","parcel-bundler":"latest",typedoc:"^0.20.37","typedoc-thunder-theme":"^0.0.3",typescript:"^5.0.4"}}}}),ie=["is_anonymous","is_community","is_featured","is_hidden","is_indexable","is_preserve_size","is_realtime","is_removed","is_sticker","is_dynamic"],ne=["suppress_chrome","is_public","is_verified"],R=e=>t=>e[t]=!!e[t],se=e=>typeof e=="string"?e:e.text,H=(e,t="")=>{const r=d({},e);r.id=String(r.id),r.tags=(r.tags||[]).map(se),r.bottle_data||(r.bottle_data={}),r.response_id=t,ie.forEach(R(r)),Object.keys(r.images||{}).forEach(a=>{const p=r.images[a];p.width=parseInt(p.width),p.height=parseInt(p.height)});const{user:i}=r;if(i){const a=d({},i);ne.forEach(R(a)),r.user=a}return r},O=e=>{const{response_id:t}=e.meta;return e.data=H(e.data,t),e},u=e=>{const{response_id:t}=e.meta;return e.data=e.data.map(r=>H(r,t)),e},ae=(typeof window<"u"?window:global)||{},oe=ae.GIPHY_API_URL||"https://api.giphy.com/v1/",T=class extends Error{constructor(e,t,r=0,i=""){super(e),this.url=t,this.status=r,this.statusText=i}},ce=class extends T{},q=T,de="@giphy/js-fetch-api: ",ue="Error fetching",pe=e=>e,o={},ge=6e4,le=6e3,he=()=>{const e=Date.now();Object.keys(o).forEach(t=>{const r=o[t].isError?le:ge;e-o[t].ts>=r&&delete o[t]})};function me(e,t={}){const{apiVersion:r=1,noCache:i=!1,normalizer:a=pe}=t,p=oe.replace(/\/v\d+\/$/,`/v${r}/`);if(he(),!o[e]||i){const f=`${p}${e}`,_=()=>te(this,null,function*(){var c,m;let S;try{const g=yield fetch(f,{method:"get"});if(g.ok){const l=yield g.json();if((c=l.meta)!=null&&c.response_id)return a(l);throw{message:"synthetic response"}}else{let l=ue;try{const y=yield g.json();y.message&&(l=y.message),(m=y.meta)!=null&&m.msg&&(l=y.meta.msg)}catch{}o[e]&&(o[e].isError=!0);let x=q;l==="This content is not available in your location"&&(x=ce),S=new x(`${de}${l}`,f,g.status,g.statusText)}}catch(g){S=new q(g.message,f),o[e]&&(o[e].isError=!0)}throw S});o[e]={request:_(),ts:Date.now()}}return o[e].request}var s=me,j=e=>e&&e.type?e.type:"gifs",fe=class{constructor(e,t={}){this.getQS=(r={})=>new URLSearchParams(d(b(d({},r),{api_key:this.apiKey,pingback_id:B()}),this.qsParams)).toString(),this.apiKey=e,this.qsParams=t}categories(e){return s(`gifs/categories?${this.getQS(e)}`)}gif(e,t){const r=t!=null&&t.internal?"internal/":"";return s(`${r}gifs/${e}?${this.getQS()}`,{normalizer:O})}gifs(e,t){return Array.isArray(e)?s(`gifs?${this.getQS({ids:e.join(",")})}`,{normalizer:u}):s(`gifs/categories/${e}/${t}?${this.getQS()}`,{normalizer:u})}emoji(e){return s(`emoji?${this.getQS(e)}`,{normalizer:u})}emojiDefaultVariations(e){return s(`emoji?${this.getQS(e)}`,{apiVersion:2,normalizer:u})}emojiVariations(e){return s(`emoji/${e}/variations?${this.getQS()}`,{apiVersion:2,normalizer:u})}animate(e,t={}){const r=this.getQS(b(d({},t),{m:e}));return s(`text/animate?${r}`,{normalizer:u})}search(e,t={}){const r=t.channel?`@${t.channel} ${e}`:e;let i;t.type==="text"&&(i=!0);const a=this.getQS(b(d({rating:"pg-13"},t),{q:r,excludeDynamicResults:i}));return s(`${j(t)}/search?${a}`,{normalizer:u})}subcategories(e,t){return s(`gifs/categories/${e}?${this.getQS(t)}`)}trending(e={}){return s(`${j(e)}/trending?${this.getQS(d({rating:"pg-13"},e))}`,{normalizer:u})}random(e){return s(`${j(e)}/random?${this.getQS(d({rating:"pg-13"},e))}`,{noCache:!0,normalizer:O})}related(e,t={}){const{type:r="gifs"}=t;return s(`${r}/related?${this.getQS(d({gif_id:e,rating:"pg-13"},t))}`,{normalizer:u})}channels(e,t={}){return s(`channels/search?${this.getQS(d({q:e,rating:"pg-13"},t))}`)}},_e=fe,U;if(typeof Z<"u"){const{version:e}=re();(U=G())!=null&&U.get("X-GIPHY-SDK-NAME")||(E("X-GIPHY-SDK-NAME","FetchAPI"),E("X-GIPHY-SDK-VERSION",e))}const I=new _e("DgjKC2iyZ1mRZ1iJfmuj8HNhrlSokj7y"),ye=function(){return{__giphy__:I,__options__:{limit:60,offset:0,rating:"g"},limit:function(e){return this.__options__.limit=e,this},getTrending:async function(){return await I.trending({limit:this.__options__.limit,q:"America"})},search:async function(e=""){return await I.search(e,{limit:this.__options__.limit,offset:this.__options__.offset,rating:this.__options__.rating,q:e})}}};export{ye as g};
