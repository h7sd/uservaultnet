import{_ as T,d as S,c as u,j as o,a as l,r as m,t as g,w as y,u as P,F as D,q as c,g as E,h as $,l as _,b as k,H as V,o as p,p as B}from"./global.properties-ieI6Xwik.js";import{a as w,f as x,d as F}from"./application-DnsIlr-S.js";import{T as I}from"./TextInput-CE1Bv1lI.js";import{S as L}from"./SectionToggle-DEryNKJ4.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./inbox.store-DKf8FrGP.js";import"./index-CaocF3Et.js";const A=S({setup:function(){const e=F(),a=c(e.userData),d=c({}),f=V(),s=E({isLoading:!0,isSubmitting:!1,formErrors:{email:[]}}),r=c({email:a.value.email,email_privacy:!0});return $(async()=>{await _().userSettings().getFrom("email/settings").then(t=>{let i=t.data.data;d.value=i.validation_rules,r.value.email=i.email,r.value.email_privacy=i.privacy_settings.email_privacy}),s.isLoading=!1}),{formData:r,validationRules:d,state:s,submitForm:async()=>{s.isSubmitting===!1&&(s.isSubmitting=!0,Object.keys(s.formErrors).forEach(t=>{s.formErrors[t]=[]}),await _().userSettings().with(r.value).putTo("email/update").then(t=>{t.data.data.confirmation_required?f.push({name:"settings_email_confirm"}):toastSuccess(__t("toast.forms.changes_saved"))}).catch(t=>{t.response&&(toastError(t.response.data.message),t.response.data.errors&&Object.keys(t.response.data.errors).forEach(i=>{s.formErrors[i]=t.response.data.errors[i]}))}),s.isSubmitting=!1)},isSubmitDenied:k(()=>!1)}},components:{PrimaryPillButton:x,TextInput:I,PageTitle:w,SectionToggle:L}}),N={class:"mb-8"},R={key:0,class:"block"},j={class:"mb-8"},C={class:"text-par-m text-lab-sc"},q={class:"mb-10"},M={class:"mb-10"},O={class:"block mb-16"},U={key:1,class:"block"},H={class:"flex-center h-96"};function z(e,a,d,f,s,r){const t=m("PageTitle"),i=m("TextInput"),b=m("SectionToggle"),v=m("PrimaryPillButton"),h=m("PrimarySpinAnimation");return p(),u(D,null,[o("div",N,[l(t,{hasBack:!0,titleText:e.$t("settings.email_settings")},null,8,["titleText"])]),e.state.isLoading?(p(),u("div",U,[o("div",H,[l(h)])])):(p(),u("div",R,[o("div",j,[o("h6",C,g(e.$t("settings.forms.email_address.page_desc")),1)]),o("form",{onSubmit:a[2]||(a[2]=P((...n)=>e.submitForm&&e.submitForm(...n),["prevent"]))},[o("div",q,[l(i,{textLength:e.validationRules.email.max,modelValue:e.formData.email,"onUpdate:modelValue":a[0]||(a[0]=n=>e.formData.email=n),inputErrors:e.state.formErrors.email,labelText:e.$t("settings.forms.email_address.email_address"),placeholder:e.$t("settings.forms.email_address.email_address_placeholder")},{feedbackInfo:y(()=>[B(g(e.$t("settings.forms.email_address.email_address_helper")),1)]),_:1},8,["textLength","modelValue","inputErrors","labelText","placeholder"])]),o("div",M,[l(b,{iconName:"shield-01",modelValue:e.formData.email_privacy,"onUpdate:modelValue":a[1]||(a[1]=n=>e.formData.email_privacy=n),captionText:e.$t("settings.forms.email_address.privacy_helper"),titleText:e.$t("labels.privacy")},null,8,["modelValue","captionText","titleText"])]),o("div",O,[l(v,{isDisabled:e.isSubmitDenied,loading:e.state.isSubmitting,buttonType:"submit",buttonText:e.$t("labels.save_changes")},null,8,["isDisabled","loading","buttonText"])])],32)]))],64)}const Z=T(A,[["render",z]]);export{Z as default};
