const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReactionsViewer-DCDPlTYr.js","assets/global.properties-ieI6Xwik.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/ReactionsPicker-CgljJK1r.js","assets/smileys-and-emotions-Beo3QNJK.js","assets/swiper-element-bundle-DBu82uhE.js","assets/PanelHeader-pG5k2GZi.js","assets/application-DnsIlr-S.js","assets/inbox.store-DKf8FrGP.js","assets/index-CaocF3Et.js","assets/PublicationImage-Cv4-2TkA.js","assets/index-CZvQntMR.js","assets/ProgressiveImageLoader-DUluSfqC.js","assets/SpinnerIcon-D3U9frcO.js","assets/PublicationGif-CKFOU4iO.js","assets/GiphyAttribution-Cv2rUDbj.js","assets/PublicationVideo-B7QtEF4x.js","assets/media.status-D6lx-p4W.js","assets/index-Dun6B87D.js","assets/VideoDurationTime-CY2-hNg2.js","assets/PublicationDocument-Bcorkym-.js","assets/PublicationAudio-CehbMQTH.js","assets/audio.store-BoPbokKE.js","assets/PublicationPoll-Bup7LS49.js","assets/PublicationText-RsW-9Uwk.js","assets/index-DyH4rDzV.js","assets/mention.plugin-6T_AP_1M.js","assets/AvatarExtraSmall-CzXHXk-G.js","assets/PublicationShare-Cu16cEUI.js","assets/ShareContent-siZXvPb7.js","assets/MarginalTextButton-Cjg6Hj8c.js","assets/PublicationQuotePlaceholder-CQfNtVQQ.js","assets/LinkSnapshot-D4bCBbRO.js","assets/LinkSnapshot-D9dLwJZT.js"])))=>i.map(i=>d[i]);
import{_ as ee,d as te,c as l,j as s,a as o,r as a,w as b,m as i,e as r,t as f,u as C,v as A,x as oe,F as L,i as ne,p as V,y as p,z as m,g as ae,q as se,b as u,P as ie,A as le,B as M,l as O,o as t}from"./global.properties-ieI6Xwik.js";import{P as re,D as de,b as ue,c as ce,A as pe,u as me}from"./application-DnsIlr-S.js";import{T as _e,a as ke,D as be,c as he}from"./TranslationService-ew0KueNY.js";import{V as ve}from"./ViewsCounter-7KyRmWQv.js";import Pe from"./PublicationQuote-1qpVpjjc.js";const fe=te({props:{isPinned:{type:Boolean,default:!1},postData:{type:Object,default:{}}},setup:function(e){const h=le(),c=ae({isMenuOpen:!1,isReactionPickerOpen:!1,isTranslating:!1,isTranslated:!1,isSharePostOpen:!1}),T=se(""),n=u(()=>e.postData),I=me(),w=function(){debounce(()=>{c.isReactionPickerOpen=!0},50)},g=function(){c.isReactionPickerOpen=!1},v=u(()=>c.isTranslated?T.value:n.value.content),k=u(()=>base_url(`publication/${n.value.hash_id}`));return{toggleMenu:()=>{c.isMenuOpen=!c.isMenuOpen},postContent:v,openReactionsPicker:w,PostTypeUtils:ie,closeReactionsPicker:g,postData:n,state:c,isSensitive:u(()=>n.value.meta.is_sensitive),userLocaleName:embedder("locale_name"),addReaction:d=>{g(),O().userTimeline().with({unified_id:d,post_id:n.value.id}).sendTo("post/reaction/add").then(P=>{n.value.relations.reactions=P.data.data}).catch(P=>{P.response&&toastError(P.response.data.message)})},postHasMedia:u(()=>{var d;return(d=n.value.relations.media)==null?void 0:d.length}),postHasPoll:u(()=>n.value.relations.poll),postHasContent:u(()=>n.value.content.length),postLinkSnapshot:u(()=>n.value.relations.link_snapshot),quotedPost:u(()=>n.value.relations.quoted_post),isTranslatable:u(()=>n.value.meta.is_translatable),postMedia:u(()=>n.value.relations.media),postPoll:u(()=>n.value.relations.poll),postLink:k,postReactions:u(()=>n.value.relations.reactions),lightboxImages:()=>{I.add({albumName:`${n.value.relations.user.name} ${n.value.relations.user.caption}`,date:n.value.date.iso,images:n.value.relations.media.map(d=>d.source_url)})},postUserCaption:u(()=>n.value.relations.user.caption),canDeletePost:u(()=>n.value.meta.permissions.can_delete),canReportPost:u(()=>n.value.meta.permissions.can_report),mentionAuthor:()=>{M.emit("post-editor:open",{mentionName:n.value.relations.user.username})},bookmarkPost:()=>{O().userTimeline().with({id:n.value.id}).sendTo("post/bookmarks/add").then(d=>{n.value.meta.activity.bookmarked=d.data.data.bookmarked,d.data.data.bookmarked?toastSuccess(__t("toast.post.bookmarked")):toastSuccess(__t("toast.post.unbookmarked"))}).catch(d=>{d.response&&toastError(d.response.data.message)})},translate:async()=>{if(c.isTranslating||c.isTranslated)return!1;c.isTranslating=!0;const d=await he().translate(v.value);d&&(T.value=d,c.isTranslated=!0),c.isTranslating=!1},cancelTranslation:()=>{c.isTranslated=!1,T.value=""},copyContent:()=>{navigator.clipboard.writeText(v.value).then(()=>{toastSuccess(__t("toast.post.content_copied"),1e3)})},copyLink:()=>{navigator.clipboard.writeText(k.value).then(()=>{toastSuccess(__t("toast.post.link_copied"),1e3)})},reportPost:()=>{M.emit("report:open",{type:"post",reportableId:n.value.id})},quotePost:()=>{M.emit("post-editor:open",{quotePostId:n.value.id})},sharePost:async()=>{debounce(()=>{c.isSharePostOpen=!0},50)},cancelSharePost:()=>{c.isSharePostOpen=!1},isOnPostPage:u(()=>h.name==="publication_index")}},components:{AvatarSmall:pe,DropdownButton:ce,DropdownMenu:ue,DropdownMenuItem:de,DropdownReactions:be,PrimaryIconButton:re,TextTranslateButton:ke,PublicationQuote:Pe,ReactionsViewer:p(()=>m(()=>import("./ReactionsViewer-DCDPlTYr.js"),__vite__mapDeps([0,1,2]))),ViewsCounter:ve,TranslationService:_e,ReactionsPicker:p(()=>m(()=>import("./ReactionsPicker-CgljJK1r.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9]))),PublicationImage:p(()=>m(()=>import("./PublicationImage-Cv4-2TkA.js"),__vite__mapDeps([10,11,1,2,12,13]))),PublicationGif:p(()=>m(()=>import("./PublicationGif-CKFOU4iO.js"),__vite__mapDeps([14,15,1,2]))),PublicationVideo:p(()=>m(()=>import("./PublicationVideo-B7QtEF4x.js"),__vite__mapDeps([16,1,2,17,18,7,8,9,19,13]))),PublicationDocument:p(()=>m(()=>import("./PublicationDocument-Bcorkym-.js"),__vite__mapDeps([20,7,1,2,8,9]))),PublicationAudio:p(()=>m(()=>import("./PublicationAudio-CehbMQTH.js"),__vite__mapDeps([21,1,2,22,17,7,8,9]))),PublicationPoll:p(()=>m(()=>import("./PublicationPoll-Bup7LS49.js"),__vite__mapDeps([23,1,2,7,8,9]))),PublicationText:p(()=>m(()=>import("./PublicationText-RsW-9Uwk.js"),__vite__mapDeps([24,25,26,1,2]))),AvatarExtraSmall:p(()=>m(()=>import("./AvatarExtraSmall-CzXHXk-G.js"),__vite__mapDeps([27,1,2]))),PublicationShare:p(()=>m(()=>import("./PublicationShare-Cu16cEUI.js"),__vite__mapDeps([28,7,1,2,8,9,6,29,30]))),PublicationQuotePlaceholder:p(()=>m(()=>import("./PublicationQuotePlaceholder-CQfNtVQQ.js"),__vite__mapDeps([31,1,2]))),LinkSnapshot:p(()=>m(()=>import("./LinkSnapshot-D4bCBbRO.js"),__vite__mapDeps([32,33,1,2])))}}),ye={class:"relative border-b border-b-bord-tr last:border-none"},Te={class:"absolute overflow-hidden top-4 left-4"},ge={class:"px-4 pt-4 max-w-full"},De={class:"ml-small-avatar pl-2"},Ce={class:"overflow-hidden mb-1"},Le={class:"flex items-center overflow-hidden"},we={class:"leading-4 flex-1 overflow-hidden"},Se={class:"text-par-m text-lab-pr2 truncate"},Re={class:"flex items-center gap-1"},Ae={class:"shrink-0 font-semibold"},Me=["title"],Ie={class:"text-par-n text-lab-sc truncate"},Ee={key:0,class:"size-icon-x-small inline-block text-brand-900 ml-1"},Ve={class:"max-w-full"},Oe={key:0,class:"overflow-hidden mb-4"},$e={key:0,class:"leading-none mb-1"},Ne={key:1,class:"mt-2"},Be={key:1,class:"overflow-hidden mb-2"},qe={key:2,class:"overflow-hidden mb-4"},ze={key:3,class:"overflow-hidden mb-2"},Ue={key:4,class:"overflow-hidden mb-2"},He=["href"],Qe={key:5,class:"block"},Ge={class:"block mb-3 -ml-1"},je={class:"flex items-center"},Fe={class:"shrink-0 relative leading-zero"},Je={class:"absolute left-0 bottom-8 origin-top-left z-20"},Ke={class:"shrink-0 leading-zero relative"},We={class:"absolute left-0 bottom-8 origin-top-left z-20"},Xe={key:0,class:"shrink-0"},Ye={class:"flex-1 overflow-hidden"},Ze={key:0,class:"flex items-center h-x-small-avatar"},xe={key:0,class:"flex ml-1"},et={class:"flex-1 overflow-hidden ml-2"},tt={class:"shrink-0 self-end"},ot={class:"absolute top-2 right-2.5"},nt={class:"relative leading-none"},at={class:"opacity-30 hover:opacity-100"},st={key:0,class:"absolute top-full right-0 z-50"};function it(e,h,c,T,n,I){const w=a("AvatarSmall"),g=a("VerificationBadge"),v=a("SvgIcon"),k=a("RouterLink"),d=a("TextTranslateButton"),P=a("PublicationText"),$=a("TranslationService"),N=a("PublicationImage"),B=a("PublicationGif"),q=a("PublicationVideo"),z=a("PublicationDocument"),U=a("PublicationAudio"),H=a("PublicationPoll"),Q=a("PublicationQuote"),G=a("PublicationQuotePlaceholder"),j=a("LinkSnapshot"),F=a("ReactionsViewer"),D=a("PrimaryIconButton"),J=a("ReactionsPicker"),E=a("PrimaryTransition"),K=a("PublicationShare"),W=a("AvatarExtraSmall"),X=a("ViewsCounter"),Y=a("DropdownButton"),Z=a("DropdownReactions"),_=a("DropdownMenuItem"),S=a("Border"),x=a("DropdownMenu"),R=oe("outside-click");return t(),l("div",ye,[s("div",Te,[o(w,{avatarSrc:e.postData.relations.user.avatar_url},null,8,["avatarSrc"])]),s("div",ge,[s("div",De,[s("div",Ce,[s("div",Le,[s("div",we,[o(k,{to:{name:"profile_index",params:{id:e.postData.relations.user.username}},class:"flex cursor-pointer gap-1"},{default:b(()=>[s("h3",Se,[s("span",Re,[s("span",Ae,f(e.postData.relations.user.name),1),e.postData.relations.user.verified?(t(),r(g,{key:0})):i("",!0),e.postData.meta.is_ai_generated?(t(),l("span",{key:1,title:e.$t("labels.ai_generated"),class:"size-icon-x-small inline-block text-amber-500"},[o(v,{name:"ai-icon"})],8,Me)):i("",!0)])]),s("span",Ie,f(e.postUserCaption)+" Â· "+f(e.postData.date.time_ago),1),e.isPinned?(t(),l("span",Ee,[o(v,{name:"pin-02"})])):i("",!0)]),_:1},8,["to"])])])]),s("div",Ve,[e.postHasContent?(t(),l("div",Oe,[e.postData.meta.is_translatable?(t(),l("div",$e,[e.state.isTranslated?(t(),r(d,{key:0,onClick:e.cancelTranslation,buttonText:e.$t("labels.show_untranslated")},null,8,["onClick","buttonText"])):(t(),r(d,{key:1,onClick:e.translate,buttonText:e.state.isTranslating?e.$t("labels.translating"):e.$t("labels.translate_to",{language_name:e.userLocaleName})},null,8,["onClick","buttonText"]))])):i("",!0),o(P,{postContent:e.postContent},null,8,["postContent"]),e.state.isTranslated?(t(),l("div",Ne,[o($)])):i("",!0)])):i("",!0),e.postHasMedia?(t(),l("div",Be,[e.PostTypeUtils.isImage(e.postData.type)?(t(),l("div",{key:0,onClick:h[0]||(h[0]=(...y)=>e.lightboxImages&&e.lightboxImages(...y)),class:"block cursor-pointer rounded-2xl overflow-hidden border border-bord-card"},[(t(),r(N,{key:e.postData.hash_id,isSensitive:e.isSensitive,postMedia:e.postMedia},null,8,["isSensitive","postMedia"]))])):i("",!0),e.PostTypeUtils.isGif(e.postData.type)?(t(),r(B,{key:1,onClick:e.lightboxImages,postMedia:e.postMedia},null,8,["onClick","postMedia"])):e.PostTypeUtils.isVideo(e.postData.type)?(t(),r(q,{key:2,postMedia:e.postMedia},null,8,["postMedia"])):e.PostTypeUtils.isDocument(e.postData.type)?(t(),r(z,{key:3,postMedia:e.postMedia},null,8,["postMedia"])):e.PostTypeUtils.isAudio(e.postData.type)?(t(),r(U,{postMedia:e.postMedia,key:e.postData.id},null,8,["postMedia"])):i("",!0)])):e.postHasPoll?(t(),l("div",qe,[o(H,{postPoll:e.postPoll},null,8,["postPoll"])])):e.postData.meta.is_quoting?(t(),l("div",ze,[e.quotedPost?(t(),r(Q,{quotedPost:e.quotedPost,key:e.postData.id},null,8,["quotedPost"])):(t(),r(G,{key:1}))])):e.postLinkSnapshot?(t(),l("div",Ue,[s("a",{href:e.postLinkSnapshot.url,target:"_blank"},[o(j,{linkSnapshot:e.postLinkSnapshot},null,8,["linkSnapshot"])],8,He)])):i("",!0),e.postReactions.length?(t(),l("div",Qe,[o(F,{onAdd:e.addReaction,reactions:e.postReactions},null,8,["onAdd","reactions"])])):i("",!0),s("div",Ge,[s("div",je,[s("div",Fe,[o(D,{iconSize:"icon-normal",onClick:C(e.openReactionsPicker,["stop"]),iconName:"heart-rounded",iconType:"line"},null,8,["onClick"]),e.state.isReactionPickerOpen?(t(),r(E,{key:0},{default:b(()=>[s("div",Je,[A(o(J,{onAdd:e.addReaction},null,8,["onAdd"]),[[R,e.closeReactionsPicker]])])]),_:1})):i("",!0)]),s("div",Ke,[o(D,{onClick:C(e.sharePost,["stop"]),iconSize:"icon-normal",iconName:"share-06",iconType:"line"},null,8,["onClick"]),e.state.isSharePostOpen?(t(),r(E,{key:0},{default:b(()=>[s("div",We,[A(o(K,{onClick:C(e.cancelSharePost,["stop"]),postLink:e.postLink},null,8,["onClick","postLink"]),[[R,e.cancelSharePost]])])]),_:1})):i("",!0)]),!e.postData.relations.comments.length&&!e.isOnPostPage?(t(),l("div",Xe,[o(k,{to:{name:"publication_index",params:{hash_id:e.postData.hash_id}}},{default:b(()=>[o(D,{iconSize:"icon-normal",iconName:"message-circle-02",iconType:"line"})]),_:1},8,["to"])])):i("",!0),e.isOnPostPage?(t(),r(D,{key:1,disabled:!0,iconSize:"icon-normal",iconName:"message-circle-02",iconType:"line"})):i("",!0),s("div",Ye,[e.isOnPostPage?i("",!0):(t(),l("div",Ze,[e.postData.relations.comments.length?(t(),l("div",xe,[(t(!0),l(L,null,ne(e.postData.relations.comments,y=>(t(),l("div",{key:y.id,class:"-ml-2 first:ml-0 border rounded-full border-fill-pr"},[o(W,{avatarSrc:y.user.avatar_url},null,8,["avatarSrc"])]))),128))])):i("",!0),s("div",et,[o(k,{to:{name:"publication_index",params:{hash_id:e.postData.hash_id}},class:"text-par-s text-lab-sc truncate block hover:text-brand-900"},{default:b(()=>[e.postData.relations.comments.length?(t(),l(L,{key:0},[V(f(e.$t("labels.show_all_comments"))+" ("+f(e.postData.comments_count.formatted)+") ",1)],64)):(t(),l(L,{key:1},[V(f(e.$t("labels.leave_comment")),1)],64))]),_:1},8,["to"])])]))]),s("div",tt,[o(X,{counterValue:e.postData.views_count.formatted},null,8,["counterValue"])])])])])])]),s("div",ot,[s("div",nt,[s("div",at,[o(Y,{onClick:C(e.toggleMenu,["stop"])},null,8,["onClick"])]),e.state.isMenuOpen?(t(),l("div",st,[A((t(),r(x,{onClick:e.toggleMenu},{default:b(()=>[o(Z,{onAdd:e.addReaction},null,8,["onAdd"]),o(_,{onClick:e.openReactionsPicker,iconName:"heart-rounded",textLabel:e.$t("dd.add_reaction")},null,8,["onClick","textLabel"]),e.postHasContent&&e.isTranslatable?(t(),l(L,{key:0},[e.state.isTranslated?(t(),r(_,{key:0,onClick:e.cancelTranslation,iconName:"translate-01",textLabel:e.$t("labels.show_untranslated")},null,8,["onClick","textLabel"])):(t(),r(_,{key:1,onClick:e.translate,iconName:"translate-01",textLabel:e.$t("dd.translate")},null,8,["onClick","textLabel"]))],64)):i("",!0),o(S),e.isOnPostPage?i("",!0):(t(),r(k,{key:1,to:{name:"publication_index",params:{hash_id:e.postData.hash_id}}},{default:b(()=>[o(_,{iconName:"arrow-up-right",textLabel:e.$t("dd.post.open_post")},null,8,["textLabel"])]),_:1},8,["to"])),o(_,{onClick:e.quotePost,iconName:"pencil-line",textLabel:e.$t("dd.post.quote_post")},null,8,["onClick","textLabel"]),o(_,{onClick:e.mentionAuthor,iconName:"at-sign",textLabel:e.$t("dd.post.mention_author",{name:`@${e.postData.relations.user.name}`})},null,8,["onClick","textLabel"]),o(S),o(_,{onClick:e.bookmarkPost,iconName:e.postData.meta.activity.bookmarked?"bookmark-minus":"bookmark",textLabel:e.postData.meta.activity.bookmarked?e.$t("dd.post.unbookmark"):e.$t("dd.post.bookmark")},null,8,["onClick","iconName","textLabel"]),o(_,{onClick:e.sharePost,iconName:"share-06",textLabel:e.$t("dd.post.share")},null,8,["onClick","textLabel"]),o(_,{onClick:e.copyLink,iconName:"copy-06",textLabel:e.$t("dd.post.copy_link")},null,8,["onClick","textLabel"]),e.postHasContent?(t(),r(_,{key:2,onClick:e.copyContent,iconName:"type-01",textLabel:e.$t("dd.copy_text")},null,8,["onClick","textLabel"])):i("",!0),o(S),e.canReportPost?(t(),r(_,{key:3,onClick:e.reportPost,itemColor:"text-red-900",iconName:"annotation-alert",textLabel:e.$t("dd.post.report_post")},null,8,["onClick","textLabel"])):i("",!0),e.canDeletePost?(t(),r(_,{key:4,onClick:h[1]||(h[1]=y=>e.$emit("delete",e.postData)),itemColor:"text-red-900",iconName:"trash-04",textLabel:e.$t("dd.post.delete_post")},null,8,["textLabel"])):i("",!0)]),_:1},8,["onClick"])),[[R,e.toggleMenu]])])):i("",!0)])])])}const pt=ee(fe,[["render",it]]);export{pt as T};
