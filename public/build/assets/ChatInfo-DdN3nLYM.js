import{u as b}from"./chat.store-DbSkwILP.js";import{_ as C,d as y,r as l,c as u,o as c,j as s,t as g,a as o,F as T,i as w,e as v,g as B,b as $,h as k,q as S,G as D,B as _,H as I}from"./global.properties-ieI6Xwik.js";import{a as N,j as f}from"./application-DnsIlr-S.js";import{M as R}from"./ModalRowButton-DQqFuzSn.js";import{C as M}from"./MessengerChat-BgxWHlJS.js";import{P as q}from"./ParticipantItem-DEyxw5wt.js";import"./inbox.store-DKf8FrGP.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-CaocF3Et.js";import"./ChatHeaderSkeleton-BtBb8mwX.js";import"./AvatarMedium-BDR98hYM.js";import"./TranslationService-ew0KueNY.js";import"./swiper-element-bundle-DBu82uhE.js";import"./AvatarNormal-QOljNkCM.js";const x=y({props:{chatData:{type:Object,required:!0}},setup:function(t,m){const h=B({isLoading:!0}),e=b(),a=$(()=>e.chatParticipants);return k(async()=>{try{await e.fetchChatParticipants(),h.isLoading=!1}catch(i){alert(i)}}),{chatParticipants:a,state:h}},components:{ParticipantItem:q}}),O={class:"block"},E={class:"mb-4 px-4"},L={class:"text-lab-pr text-par-m font-medium"},j={key:0,class:"block"},G={class:"flex-center h-24"},A={key:1},F={class:"block max-h-[500px] overflow-y-auto py-1"};function V(t,m,h,e,a,i){const r=l("PrimarySpinAnimation"),d=l("ParticipantItem");return c(),u("div",O,[s("div",E,[s("h4",L,g(t.$t("chat.participants_count",{count:t.chatData.chat_info.participants_count.formatted})),1)]),t.state.isLoading?(c(),u("div",j,[s("div",G,[o(r)])])):(c(),u("div",A,[s("div",F,[(c(!0),u(T,null,w(t.chatParticipants,n=>(c(),v(d,{name:n.relations.user.name,caption:t.$t("labels.was_online_at",{time:n.relations.user.last_active.time_ago}),verified:n.relations.user.verified,avatarSrc:n.relations.user.avatar_url,username:n.relations.user.username},null,8,["name","caption","verified","avatarSrc","username"]))),256))])]))])}const H=C(x,[["render",V]]),U=y({emits:["close"],setup:function(t,m){const h=I(),e=b(),a=S(e.chatData),i=()=>{m.emit("close")};return k(()=>{f("esc",()=>{i()})}),D(()=>{f.unbind("esc")}),{chatData:a,isGroup:$(()=>a.value.type=="group"),archiveChat:async()=>{await e.archiveChat(a.value.chat_id),a.value.meta.is_archived=!0,toastSuccess(__t("toast.chat.chat_archived"))},unarchiveChat:async()=>{await e.unarchiveChat(a.value.chat_id),a.value.meta.is_archived=!1,toastSuccess(__t("toast.chat.chat_unarchived"))},clearConversation:()=>{i(),_.emit("confirmation-modal:open",{title:__t("prompt.clear_conversation.title"),description:__t("prompt.clear_conversation.desc"),confirmButtonText:__t("prompt.clear_conversation.confirm"),onConfirm:async()=>{try{e.chatMessages.length&&await e.clearChatConversation(),toastSuccess(__t("toast.chat.chat_cleared"),3e3)}catch(r){toastError(r,3e3)}}})},deleteChat:()=>{i(),_.emit("confirmation-modal:open",{title:__t("prompt.delete_chat.title"),description:__t("prompt.delete_chat.desc"),onConfirm:async()=>{try{await e.deleteChat(a.value.chat_id),h.push({name:"messenger_inbox"}),toastSuccess(__t("toast.chat.chat_deleted"),3e3)}catch(r){toastError(r,3e3)}}})},reportInterlocutor:()=>{i(),_.emit("report:open",{type:"user",reportableId:a.value.chat_info.id})}}},components:{ChatOverview:M,ModalRowButton:R,PageTitle:N,ChatParticipants:H}}),z={class:"block"},J={class:"py-4 px-4"},K={class:"mb-6"},Q={class:"py-4"},W={class:"px-4 py-4"},X={class:"text-lab-sc text-cap-l"};function Y(t,m,h,e,a,i){const r=l("PageTitle"),d=l("ChatOverview"),n=l("Border"),P=l("ChatParticipants"),p=l("ModalRowButton");return c(),u("div",z,[s("div",J,[s("div",K,[o(r,{hasBack:!1,titleText:t.$t("labels.information")},null,8,["titleText"])]),o(d)]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),s("div",Q,[o(P,{chatData:t.chatData},null,8,["chatData"])]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),t.chatData.meta.is_archived?(c(),v(p,{key:0,onClick:t.unarchiveChat,buttonText:t.$t("chat.unarchive_chat"),iconName:"archive"},null,8,["onClick","buttonText"])):(c(),v(p,{key:1,onClick:t.archiveChat,buttonText:t.$t("chat.archive_chat"),iconName:"archive"},null,8,["onClick","buttonText"])),o(p,{onClick:t.clearConversation,buttonText:t.$t("chat.clear_conversation"),iconName:"brush-03"},null,8,["onClick","buttonText"]),o(p,{onClick:t.reportInterlocutor,buttonRole:"danger",buttonText:t.$t("labels.report_this_user",{user_name:t.chatData.chat_info.name}),iconName:"annotation-alert"},null,8,["onClick","buttonText"]),o(p,{onClick:t.$comingSoon,buttonRole:"danger",buttonText:t.$t("labels.block_this_user",{user_name:t.chatData.chat_info.name}),iconName:"slash-circle-01"},null,8,["onClick","buttonText"]),o(p,{onClick:t.deleteChat,buttonRole:"danger",buttonText:t.isGroup?t.$t("chat.delete_group"):t.$t("chat.delete_chat"),iconName:"trash-04"},null,8,["onClick","buttonText"]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),s("div",W,[s("span",X,g(t.$t("chat.chat_created_date",{date:t.chatData.date.iso})),1)])])}const mt=C(U,[["render",Y]]);export{mt as default};
