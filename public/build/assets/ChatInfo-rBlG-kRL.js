import{u as b}from"./chat.store-BDVc674y.js";import{_ as C,b as _}from"./global.properties-DKM1fd6s.js";import{k as y,e as l,c as u,d as r,s,t as g,i as o,F as T,f as w,p as v,b as B,l as $,o as k,r as S,G as D,H as I}from"./vendor-20TtR0Rd.js";import{a as N,j as f}from"./application-DEz9sPnz.js";import{M as R}from"./ModalRowButton-jhxh9tnR.js";import{C as M}from"./MessengerChat-w2Nna1OX.js";import{P as x}from"./ParticipantItem-tFy88GHy.js";import"./inbox.store-CHx7CB4w.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./index-ciglwFMH.js";import"./ui-Bp8YvxdW.js";import"./ChatHeaderSkeleton-B6WgwGHO.js";import"./AvatarMedium-Dt88Ycme.js";import"./TranslationService-CWFwUQ3g.js";import"./swiper-element-bundle-DBu82uhE.js";import"./AvatarNormal-BJt0-uJ6.js";const O=y({props:{chatData:{type:Object,required:!0}},setup:function(t,m){const h=B({isLoading:!0}),a=b(),e=$(()=>a.chatParticipants);return k(async()=>{try{await a.fetchChatParticipants(),h.isLoading=!1}catch(i){alert(i)}}),{chatParticipants:e,state:h}},components:{ParticipantItem:x}}),q={class:"block"},E={class:"mb-4 px-4"},L={class:"text-lab-pr text-par-m font-medium"},G={key:0,class:"block"},j={class:"flex-center h-24"},A={key:1},F={class:"block max-h-[500px] overflow-y-auto py-1"};function V(t,m,h,a,e,i){const c=l("PrimarySpinAnimation"),d=l("ParticipantItem");return r(),u("div",q,[s("div",E,[s("h4",L,g(t.$t("chat.participants_count",{count:t.chatData.chat_info.participants_count.formatted})),1)]),t.state.isLoading?(r(),u("div",G,[s("div",j,[o(c)])])):(r(),u("div",A,[s("div",F,[(r(!0),u(T,null,w(t.chatParticipants,n=>(r(),v(d,{name:n.relations.user.name,caption:t.$t("labels.was_online_at",{time:n.relations.user.last_active.time_ago}),verified:n.relations.user.verified,avatarSrc:n.relations.user.avatar_url,username:n.relations.user.username},null,8,["name","caption","verified","avatarSrc","username"]))),256))])]))])}const H=C(O,[["render",V]]),U=y({emits:["close"],setup:function(t,m){const h=I(),a=b(),e=S(a.chatData),i=()=>{m.emit("close")};return k(()=>{f("esc",()=>{i()})}),D(()=>{f.unbind("esc")}),{chatData:e,isGroup:$(()=>e.value.type=="group"),archiveChat:async()=>{await a.archiveChat(e.value.chat_id),e.value.meta.is_archived=!0,toastSuccess(__t("toast.chat.chat_archived"))},unarchiveChat:async()=>{await a.unarchiveChat(e.value.chat_id),e.value.meta.is_archived=!1,toastSuccess(__t("toast.chat.chat_unarchived"))},clearConversation:()=>{i(),_.emit("confirmation-modal:open",{title:__t("prompt.clear_conversation.title"),description:__t("prompt.clear_conversation.desc"),confirmButtonText:__t("prompt.clear_conversation.confirm"),onConfirm:async()=>{try{a.chatMessages.length&&await a.clearChatConversation(),toastSuccess(__t("toast.chat.chat_cleared"),3e3)}catch(c){toastError(c,3e3)}}})},deleteChat:()=>{i(),_.emit("confirmation-modal:open",{title:__t("prompt.delete_chat.title"),description:__t("prompt.delete_chat.desc"),onConfirm:async()=>{try{await a.deleteChat(e.value.chat_id),h.push({name:"messenger_inbox"}),toastSuccess(__t("toast.chat.chat_deleted"),3e3)}catch(c){toastError(c,3e3)}}})},reportInterlocutor:()=>{i(),_.emit("report:open",{type:"user",reportableId:e.value.chat_info.id})}}},components:{ChatOverview:M,ModalRowButton:R,PageTitle:N,ChatParticipants:H}}),z={class:"block"},J={class:"py-4 px-4"},K={class:"mb-6"},Q={class:"py-4"},W={class:"px-4 py-4"},X={class:"text-lab-sc text-cap-l"};function Y(t,m,h,a,e,i){const c=l("PageTitle"),d=l("ChatOverview"),n=l("Border"),P=l("ChatParticipants"),p=l("ModalRowButton");return r(),u("div",z,[s("div",J,[s("div",K,[o(c,{hasBack:!1,titleText:t.$t("labels.information")},null,8,["titleText"])]),o(d)]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),s("div",Q,[o(P,{chatData:t.chatData},null,8,["chatData"])]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),t.chatData.meta.is_archived?(r(),v(p,{key:0,onClick:t.unarchiveChat,buttonText:t.$t("chat.unarchive_chat"),iconName:"archive"},null,8,["onClick","buttonText"])):(r(),v(p,{key:1,onClick:t.archiveChat,buttonText:t.$t("chat.archive_chat"),iconName:"archive"},null,8,["onClick","buttonText"])),o(p,{onClick:t.clearConversation,buttonText:t.$t("chat.clear_conversation"),iconName:"brush-03"},null,8,["onClick","buttonText"]),o(p,{onClick:t.reportInterlocutor,buttonRole:"danger",buttonText:t.$t("labels.report_this_user",{user_name:t.chatData.chat_info.name}),iconName:"annotation-alert"},null,8,["onClick","buttonText"]),o(p,{onClick:t.$comingSoon,buttonRole:"danger",buttonText:t.$t("labels.block_this_user",{user_name:t.chatData.chat_info.name}),iconName:"slash-circle-01"},null,8,["onClick","buttonText"]),o(p,{onClick:t.deleteChat,buttonRole:"danger",buttonText:t.isGroup?t.$t("chat.delete_group"):t.$t("chat.delete_chat"),iconName:"trash-04"},null,8,["onClick","buttonText"]),o(n,{height:"h-3",bg:"bg-fill-qt",opacity:"opacity-70"}),s("div",W,[s("span",X,g(t.$t("chat.chat_created_date",{date:t.chatData.date.iso})),1)])])}const vt=C(U,[["render",Y]]);export{vt as default};
