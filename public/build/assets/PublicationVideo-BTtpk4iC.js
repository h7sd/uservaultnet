const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PublicationVideoProcessing-VVJqnMuE.js","assets/application-DEz9sPnz.js","assets/global.properties-DKM1fd6s.js","assets/editor-CpZ7vO5P.js","assets/media-D4ZD3EDk.js","assets/vendor-20TtR0Rd.js","assets/inbox.store-CHx7CB4w.js","assets/index-ciglwFMH.js","assets/ui-Bp8YvxdW.js"])))=>i.map(i=>d[i]);
import{_ as b,a as M}from"./global.properties-DKM1fd6s.js";import{M as I}from"./media.status-D6lx-p4W.js";import{u as k}from"./index-DvUAJ3ty.js";import{P as V}from"./application-DEz9sPnz.js";import w from"./VideoDurationTime-DjdOjCKw.js";import{S as T}from"./SpinnerIcon-BFpWBik4.js";import{k as h,e as c,c as m,d as r,s as n,v as S,i as v,p as g,b as U,w as $,o as B,G as C,j as D,B as L,l as P}from"./vendor-20TtR0Rd.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./inbox.store-CHx7CB4w.js";import"./index-ciglwFMH.js";import"./ui-Bp8YvxdW.js";const A=h({props:{videoUrl:{type:String,required:!0},duration:{type:Object,required:!0},thumbnailUrl:{type:String,required:!0}},setup:function(e,i){const{isIntersecting:p,videoPlayerRef:o}=k({threshold:.5}),t=U({isMuted:!1,isLoaded:!1,isPlaying:!1,progressBar:0,playbackTime:0});function f(){function s(){const y=o.value.currentTime,_=o.value.duration;t.progressBar=Math.round(y/_*100),t.playbackTime=Math.round(y),t.isPlaying&&(window.colibriVideoTimer=requestAnimationFrame(s))}window.colibriVideoTimer=requestAnimationFrame(s)}function l(){cancelAnimationFrame(window.colibriVideoTimer)}$(p,s=>{s&&t.isLoaded?d():u()}),B(()=>{o.value.addEventListener("loadedmetadata",()=>{t.isLoaded=!0})}),C(()=>{o.value&&(o.value.removeEventListener("loadedmetadata",d),u())});const a=()=>{localStorage.getItem("videoPlayerMuted")?(t.isMuted=!0,o.value.muted=!0):(o.value.muted=!1,t.isMuted=!1)},d=()=>{t.isLoaded&&o.value.play().then(()=>{a(),t.isPlaying=!0,f()}).catch(s=>{s.name==="NotAllowedError"&&console.info("Cannot play video because user has not interacted with the page yet")})},u=()=>{o.value.pause(),t.isPlaying=!1,l()};return{videoPlayerRef:o,state:t,toggleMute:()=>{t.isMuted=!t.isMuted,o.value.muted=t.isMuted,t.isMuted?localStorage.setItem("videoPlayerMuted",1):localStorage.removeItem("videoPlayerMuted")},togglePlay:()=>{t.isLoaded&&(t.isPlaying?u():d())}}},components:{SpinnerIcon:T,PrimaryIconButton:V,VideoDurationTime:w}}),E={class:"relative flex justify-center cursor-pointer"},N=["poster"],j=["src"],q={key:0,class:"absolute backdrop-blur-xs inset-0 flex-center w-full h-full bg-black/50"},O={class:"size-12"},R={class:"from-black/60 to-transparent bg-gradient-to-t absolute bottom-0 left-0 right-0 px-2 pb-2 pt-6"},z={class:"flex items-center justify-between"},F={class:"ml-2 inline-flex items-center gap-2"};function G(e,i,p,o,t,f){const l=c("SpinnerIcon"),a=c("VideoDurationTime"),d=c("PrimaryIconButton");return r(),m("div",E,[n("video",{onClick:i[0]||(i[0]=(...u)=>e.togglePlay&&e.togglePlay(...u)),class:"w-full",ref:"videoPlayerRef",poster:e.thumbnailUrl,loop:"loop"},[n("source",{src:e.videoUrl,type:"video/mp4"},null,8,j)],8,N),e.state.isLoaded?S("",!0):(r(),m("div",q,[n("div",O,[v(l,{strokeColor:"stroke-white",strokeWidth:"1"})])])),n("div",R,[n("div",z,[n("div",F,[e.state.isPlaying?(r(),g(a,{key:0,videoDuration:e.$filters.secondsToDuration(e.state.playbackTime)},null,8,["videoDuration"])):(r(),g(a,{key:1,videoDuration:e.duration},null,8,["videoDuration"]))]),v(d,{onClick:e.toggleMute,iconName:e.state.isMuted?"volume-x":"volume-max",buttonColor:"text-white",iconSize:"icon-small",hoverText:"hover:text-white/80"},null,8,["onClick","iconName"])])])])}const W=b(A,[["render",G]]),H=h({props:{postMedia:{type:Object,default:{}}},setup:function(e){const i=P(()=>e.postMedia[0]);return{mediaItem:i,MediaStatusUtils:I,isPortrait:P(()=>i.value.metadata.is_portrait)}},components:{VideoPlayer:W,PublicationVideoProcessing:L(()=>M(()=>import("./PublicationVideoProcessing-VVJqnMuE.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])))}}),J={class:"flex"};function K(e,i,p,o,t,f){const l=c("PublicationVideoProcessing"),a=c("VideoPlayer");return r(),m("div",J,[e.MediaStatusUtils.isProcessing(e.mediaItem.status)?(r(),g(l,{key:0,mediaItem:e.mediaItem,isPortrait:e.isPortrait},null,8,["mediaItem","isPortrait"])):(r(),m("div",{key:1,class:D([[e.isPortrait?"w-72":"w-full"],"bg-fill-pr block border border-bord-card rounded-xl overflow-hidden"])},[v(a,{thumbnailUrl:e.mediaItem.thumbnail_url,duration:e.mediaItem.metadata.duration,videoUrl:e.mediaItem.source_url},null,8,["thumbnailUrl","duration","videoUrl"])],2))])}const le=b(H,[["render",K]]);export{le as default};
