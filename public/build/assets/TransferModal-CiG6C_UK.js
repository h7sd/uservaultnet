import{g as V,f as P,M as x,l as z}from"./application-DEz9sPnz.js";import{_ as $}from"./global.properties-DKM1fd6s.js";import{u as M}from"./WalletIndex-C1C6eX8a.js";import{M as D}from"./ModalTextInput-C-24MJhL.js";import{k as g,c as u,d as n,s as a,j as B,t as p,e as l,i as m,q as S,x as R,F as _,f as k,p as h,b as T,r as w,l as C,o as q,z as E,K as H,v as I}from"./vendor-20TtR0Rd.js";import"./inbox.store-CHx7CB4w.js";import"./index-ciglwFMH.js";import"./ui-Bp8YvxdW.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./ContentContainer-D1jAmZDw.js";import"./FluidEmptyState-DExNov7G.js";const N=g({props:{avatarSrc:{type:String,required:!0},name:{type:String,required:!0},isActive:{type:Boolean,default:!1}}}),U={class:"cursor-pointer"},A={class:"flex flex-col items-center"},L=["src"],F={class:"block text-center text-par-s text-lab-pr2 truncate max-w-full"};function j(e,t,s,i,r,c){return n(),u("div",U,[a("div",A,[a("div",{class:B(["size-full aspect-square rounded-full overflow-hidden bg-fill-qt mb-1 ring-2",[e.isActive?"ring-brand-900":"ring-fill-pr"]])},[a("img",{class:"size-full",src:e.avatarSrc,alt:"Img"},null,8,L)],2),a("span",F,p(e.name),1)])])}const K=$(N,[["render",j]]),O=g({emits:["select"],setup:function(){const e=T({isSearching:!1,isLoading:!0}),t=w(""),s=w([]),i=C(()=>r.receiverHistory),r=M();return q(async()=>{await r.fetchReceiverHistory(),e.isLoading=!1}),{walletNumber:t,state:e,searchReceivers:async()=>{e.isSearching=!0,await r.fetchReceivers(t.value).then(c=>{s.value.push(c.data.data)}).catch(c=>{s.value=[]}),e.isSearching=!1},clearSearch:()=>{t.value="",s.value=[]},receivers:s,history:i}},components:{ModalTextInput:D,UserCircleCard:K}}),W={class:"p-4"},G={class:"mb-4"},J={class:"overflow-y-auto max-h-96 p-1"},Q={key:0,class:"grid grid-cols-8 gap-4 mb-6"},X={key:1,class:"grid grid-cols-8 gap-4 mb-6"};function Y(e,t,s,i,r,c){const f=l("ModalTextInput"),d=l("UserCircleCard");return n(),u("div",W,[a("div",G,[m(f,{placeholder:e.$t("wallet.receiver_placeholder"),modelValue:e.walletNumber,"onUpdate:modelValue":t[0]||(t[0]=o=>e.walletNumber=o),onInput:e.searchReceivers,onClear:e.clearSearch,labelText:e.$t("wallet.receiver")},{feedbackInfo:S(()=>[R(p(e.$t("wallet.receiver_helper")),1)]),_:1},8,["placeholder","modelValue","onInput","onClear","labelText"])]),a("div",J,[e.state.isLoading?(n(),u("div",Q,[(n(),u(_,null,k(4,o=>a("div",{key:o,class:"size-full aspect-square skeleton-circle"})),64))])):(n(),u("div",X,[e.receivers.length?(n(!0),u(_,{key:0},k(e.receivers,o=>(n(),h(d,{key:o.id,avatarSrc:o.relations.user.avatar_url,onClick:v=>e.$emit("select",o),name:o.relations.user.name},null,8,["avatarSrc","onClick","name"]))),128)):(n(!0),u(_,{key:1},k(e.history,o=>(n(),h(d,{key:o.id,onClick:v=>e.$emit("select",o),avatarSrc:o.relations.user.avatar_url,name:o.relations.user.name},null,8,["onClick","avatarSrc","name"]))),128))]))])])}const Z=$(O,[["render",Y]]),ee=g({props:{receiverData:{type:Object,required:!0}},emits:["cancel","close"],setup:function(e,t){const s=T({isSubmitting:!1,formErrors:[]}),i=M(),r=T({amount:"",message:""});return{formData:r,state:s,commissionAmount:C(()=>r.amount*config("payment.commission.transfer")/100),makeTransfer:function(){s.isSubmitting=!0,s.formErrors=[],i.makeTransfer({amount:r.amount,wallet_number:e.receiverData.wallet_number,message:r.message}).then(c=>{toastSuccess(__t("toast.wallet.transfer.success")),i.fetchTransactions(),t.emit("close")}).catch(c=>{c.response&&(s.formErrors=c.response.data.errors.amount)}),s.isSubmitting=!1},isValidForm:C(()=>r.amount&&r.amount>0&&r.message.length<=140),clearAmount:function(){r.amount="",s.formErrors=[]}}},components:{PrimaryPillButton:P,ModalTextInput:D,PrimaryTextButton:V}}),te={class:"p-4"},ae={class:"flex justify-center mb-4"},se={class:"size-16 rounded-full bg-fill-qt inline-flex-center shrink-0"},oe={class:"text-center text-par-l text-lab-pr font-medium leading-none"},re={class:"text-center mb-6"},ne={class:"text-lab-sc text-par-s"},le={class:"block"},ie={class:"block mb-4"},ce={class:"block pb-3"},ue=["placeholder"],me={class:"mb-12 px-4"},de={key:0,class:"flex justify-center mt-4"};function pe(e,t,s,i,r,c){const f=l("SvgIcon"),d=l("ModalTextInput"),o=l("Border"),v=l("PrimaryPillButton"),y=l("PrimaryTextButton");return n(),u(_,null,[a("div",te,[a("div",ae,[a("div",se,[m(f,{name:"arrow-narrow-up-right",classes:"size-6 text-brand-900"})])]),a("h4",oe,p(e.receiverData.relations.user.name),1),a("div",re,[a("span",ne,p(e.$t("wallet.transfer")),1)]),a("div",le,[m(d,{labelText:e.$t("wallet.transfer_amount"),placeholder:e.$money("0, 00"),inputType:"number",inputErrors:e.state.formErrors,onClear:e.clearAmount,modelValue:e.formData.amount,"onUpdate:modelValue":t[0]||(t[0]=b=>e.formData.amount=b)},{feedbackInfo:S(()=>[R(p(e.formData.amount?e.$t("wallet.transfer_commission_amount",{commission_amount:e.$money(e.commissionAmount)}):e.$t("wallet.transfer_commission_helper")),1)]),_:1},8,["labelText","placeholder","inputErrors","onClear","modelValue"])])]),a("div",ie,[m(o,{height:"h-3",opacity:"opacity-70"}),a("div",ce,[E(a("textarea",{"onUpdate:modelValue":t[1]||(t[1]=b=>e.formData.message=b),class:"resize-none w-full pl-4 pr-12 leading-5 pt-3.5 pb-6 bg-transparent text-par-n text-lab-pr2 max-h-96 overflow-y-auto min-h-28 outline-hidden placeholder:font-light placeholder:text-par-s",placeholder:e.$t("wallet.transfer_message")},null,8,ue),[[H,e.formData.message]]),a("span",{class:B(["block text-cap-l px-4",[e.formData.message.length>140?"text-red-900":"text-lab-sc"]])},p(e.formData.message.length)+"/140",3)]),m(o)]),a("div",me,[m(v,{onClick:e.makeTransfer,loading:e.state.isSubmitting,buttonType:"button",buttonFluid:!0,buttonRole:"accent",buttonSize:"lm",buttonText:e.$t("wallet.make_transfer"),disabled:!e.isValidForm},null,8,["onClick","loading","buttonText","disabled"]),e.state.isSubmitting?I("",!0):(n(),u("div",de,[m(y,{buttonRole:"marginal",onClick:t[2]||(t[2]=b=>e.$emit("cancel")),buttonText:e.$t("wallet.reselect_receiver")},null,8,["buttonText"])]))])],64)}const fe=$(ee,[["render",pe]]),ve=g({emits:["close"],setup:function(e,t){const s=w(null);return{selectReceiver:i=>{s.value=i},cancelTransfer:()=>{s.value=null},receiverData:s}},components:{ContentModal:z,ModalHeader:x,SelectReceiver:Z,MakeTransfer:fe}}),he={class:"block"},be={class:"block p-4 pt-0"},_e=["innerHTML"];function $e(e,t,s,i,r,c){const f=l("ModalHeader"),d=l("MakeTransfer"),o=l("SelectReceiver"),v=l("ContentModal");return n(),h(v,{onClose:t[1]||(t[1]=y=>e.$emit("close"))},{default:S(()=>[m(f,{modalTitle:e.$t("wallet.transfer_money")},null,8,["modalTitle"]),a("div",he,[e.receiverData?(n(),h(d,{key:0,onCancel:e.cancelTransfer,onClose:t[0]||(t[0]=y=>e.$emit("close")),receiverData:e.receiverData},null,8,["onCancel","receiverData"])):(n(),h(o,{key:1,onSelect:e.selectReceiver},null,8,["onSelect"]))]),a("div",be,[a("p",{class:"text-par-s text-lab-sc",innerHTML:e.$t("wallet.tos_agree",{tos_link:e.$getRoute("terms_of_use")})},null,8,_e)])]),_:1})}const Pe=$(ve,[["render",$e]]);export{Pe as default};
