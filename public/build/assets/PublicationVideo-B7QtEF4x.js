const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PublicationVideoProcessing-9wygEPuB.js","assets/application-DnsIlr-S.js","assets/global.properties-ieI6Xwik.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/inbox.store-DKf8FrGP.js","assets/index-CaocF3Et.js"])))=>i.map(i=>d[i]);
import{_ as b,d as h,r as c,c as m,o as r,j as n,m as M,a as v,e as g,g as I,I as k,h as V,G as w,n as T,y as S,z as U,b as P}from"./global.properties-ieI6Xwik.js";import{M as $}from"./media.status-D6lx-p4W.js";import{u as C}from"./index-Dun6B87D.js";import{P as B}from"./application-DnsIlr-S.js";import D from"./VideoDurationTime-CY2-hNg2.js";import{S as L}from"./SpinnerIcon-D3U9frcO.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./inbox.store-DKf8FrGP.js";import"./index-CaocF3Et.js";const A=h({props:{videoUrl:{type:String,required:!0},duration:{type:Object,required:!0},thumbnailUrl:{type:String,required:!0}},setup:function(e,i){const{isIntersecting:p,videoPlayerRef:o}=C({threshold:.5}),t=I({isMuted:!1,isLoaded:!1,isPlaying:!1,progressBar:0,playbackTime:0});function f(){function s(){const y=o.value.currentTime,_=o.value.duration;t.progressBar=Math.round(y/_*100),t.playbackTime=Math.round(y),t.isPlaying&&(window.colibriVideoTimer=requestAnimationFrame(s))}window.colibriVideoTimer=requestAnimationFrame(s)}function l(){cancelAnimationFrame(window.colibriVideoTimer)}k(p,s=>{s&&t.isLoaded?d():u()}),V(()=>{o.value.addEventListener("loadedmetadata",()=>{t.isLoaded=!0})}),w(()=>{o.value&&(o.value.removeEventListener("loadedmetadata",d),u())});const a=()=>{localStorage.getItem("videoPlayerMuted")?(t.isMuted=!0,o.value.muted=!0):(o.value.muted=!1,t.isMuted=!1)},d=()=>{t.isLoaded&&o.value.play().then(()=>{a(),t.isPlaying=!0,f()}).catch(s=>{s.name==="NotAllowedError"&&console.info("Cannot play video because user has not interacted with the page yet")})},u=()=>{o.value.pause(),t.isPlaying=!1,l()};return{videoPlayerRef:o,state:t,toggleMute:()=>{t.isMuted=!t.isMuted,o.value.muted=t.isMuted,t.isMuted?localStorage.setItem("videoPlayerMuted",1):localStorage.removeItem("videoPlayerMuted")},togglePlay:()=>{t.isLoaded&&(t.isPlaying?u():d())}}},components:{SpinnerIcon:L,PrimaryIconButton:B,VideoDurationTime:D}}),E={class:"relative flex justify-center cursor-pointer"},N=["poster"],j=["src"],q={key:0,class:"absolute backdrop-blur-xs inset-0 flex-center w-full h-full bg-black/50"},z={class:"size-12"},O={class:"from-black/60 to-transparent bg-gradient-to-t absolute bottom-0 left-0 right-0 px-2 pb-2 pt-6"},R={class:"flex items-center justify-between"},F={class:"ml-2 inline-flex items-center gap-2"};function G(e,i,p,o,t,f){const l=c("SpinnerIcon"),a=c("VideoDurationTime"),d=c("PrimaryIconButton");return r(),m("div",E,[n("video",{onClick:i[0]||(i[0]=(...u)=>e.togglePlay&&e.togglePlay(...u)),class:"w-full",ref:"videoPlayerRef",poster:e.thumbnailUrl,loop:"loop"},[n("source",{src:e.videoUrl,type:"video/mp4"},null,8,j)],8,N),e.state.isLoaded?M("",!0):(r(),m("div",q,[n("div",z,[v(l,{strokeColor:"stroke-white",strokeWidth:"1"})])])),n("div",O,[n("div",R,[n("div",F,[e.state.isPlaying?(r(),g(a,{key:0,videoDuration:e.$filters.secondsToDuration(e.state.playbackTime)},null,8,["videoDuration"])):(r(),g(a,{key:1,videoDuration:e.duration},null,8,["videoDuration"]))]),v(d,{onClick:e.toggleMute,iconName:e.state.isMuted?"volume-x":"volume-max",buttonColor:"text-white",iconSize:"icon-small",hoverText:"hover:text-white/80"},null,8,["onClick","iconName"])])])])}const W=b(A,[["render",G]]),H=h({props:{postMedia:{type:Object,default:{}}},setup:function(e){const i=P(()=>e.postMedia[0]);return{mediaItem:i,MediaStatusUtils:$,isPortrait:P(()=>i.value.metadata.is_portrait)}},components:{VideoPlayer:W,PublicationVideoProcessing:S(()=>U(()=>import("./PublicationVideoProcessing-9wygEPuB.js"),__vite__mapDeps([0,1,2,3,4,5])))}}),J={class:"flex"};function K(e,i,p,o,t,f){const l=c("PublicationVideoProcessing"),a=c("VideoPlayer");return r(),m("div",J,[e.MediaStatusUtils.isProcessing(e.mediaItem.status)?(r(),g(l,{key:0,mediaItem:e.mediaItem,isPortrait:e.isPortrait},null,8,["mediaItem","isPortrait"])):(r(),m("div",{key:1,class:T([[e.isPortrait?"w-72":"w-full"],"bg-fill-pr block border border-bord-card rounded-xl overflow-hidden"])},[v(a,{thumbnailUrl:e.mediaItem.thumbnail_url,duration:e.mediaItem.metadata.duration,videoUrl:e.mediaItem.source_url},null,8,["thumbnailUrl","duration","videoUrl"])],2))])}const ae=b(H,[["render",K]]);export{ae as default};
