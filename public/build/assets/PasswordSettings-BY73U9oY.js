import{_ as y,d as S,c as p,j as a,a as n,r as l,w as d,u as $,F as k,q as c,g as E,h as B,l as m,o as u,p as w,t as _}from"./global.properties-ieI6Xwik.js";import{g as V,a as I,f as D}from"./application-DnsIlr-S.js";import{T as L}from"./TextInput-CE1Bv1lI.js";import{S as x}from"./SectionToggle-DEryNKJ4.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./inbox.store-DKf8FrGP.js";import"./index-CaocF3Et.js";const F=S({setup:function(){const s=c({}),t=c({password:"",new_password:"",logout_other_devices:!1}),o=E({isLoading:!0,isSubmitting:!1,isGenerating:!1,formErrors:{password:[],new_password:[]}});return B(async()=>{await m().userSettings().getFrom("password/settings").then(e=>{let r=e.data.data;s.value=r.validation_rules,o.isLoading=!1})}),{state:o,formData:t,validationRules:s,generatePassword:async()=>{o.isGenerating=!0,await m().userSettings().getFrom("password/generate").then(e=>{t.value.new_password=e.data.data.password,o.isGenerating=!1,navigator.clipboard.writeText(t.value.new_password).then(()=>{toastSuccess(__t("settings.forms.password_settings.new_password_copied"))}).catch(r=>{console.error("Failed to copy text: ",r)})})},submitForm:async()=>{o.isSubmitting===!1&&(o.isSubmitting=!0,Object.keys(o.formErrors).forEach(e=>{o.formErrors[e]=[]}),await m().userSettings().with(t.value).putTo("password/update").then(e=>{toastSuccess(__t("toast.forms.changes_saved")),t.value.password="",t.value.new_password=""}).catch(e=>{e.response&&(toastSuccess(e.response.data.message),e.response.data.errors&&Object.keys(e.response.data.errors).forEach(r=>{o.formErrors[r]=e.response.data.errors[r]}))}),o.isSubmitting=!1)}}},components:{PrimaryPillButton:D,TextInput:L,PageTitle:I,SectionToggle:x,PrimaryTextButton:V}}),M={class:"mb-8"},C={key:0,class:"block"},G={class:"mb-8"},H=["innerHTML"],N={class:"mb-10"},j={class:"mb-10"},A={class:"mb-10 leading-none"},R={class:"mb-10"},U=["innerHTML"],O={class:"block mb-16"},q={key:1,class:"block"},z={class:"flex-center h-96"};function J(s,t,o,e,r,K){const f=l("PageTitle"),g=l("TextInput"),b=l("SvgIcon"),T=l("PrimaryTextButton"),h=l("SectionToggle"),v=l("PrimaryPillButton"),P=l("PrimarySpinAnimation");return u(),p(k,null,[a("div",M,[n(f,{hasBack:!0,titleText:s.$t("settings.password_settings")},null,8,["titleText"])]),s.state.isLoading?(u(),p("div",q,[a("div",z,[n(P)])])):(u(),p("div",C,[a("div",G,[a("h6",{class:"text-par-s text-lab-sc",innerHTML:s.$t("settings.forms.password_settings.page_desc")},null,8,H)]),a("form",{onSubmit:t[3]||(t[3]=$((...i)=>s.submitForm&&s.submitForm(...i),["prevent"]))},[a("div",N,[n(g,{modelValue:s.formData.password,"onUpdate:modelValue":t[0]||(t[0]=i=>s.formData.password=i),inputErrors:s.state.formErrors.password,isPassword:!0,labelText:s.$t("settings.forms.password_settings.current_password"),placeholder:s.$t("settings.forms.password_settings.password_placeholder")},{feedbackInfo:d(()=>[w(_(s.$t("settings.forms.password_settings.current_password_helper")),1)]),_:1},8,["modelValue","inputErrors","labelText","placeholder"])]),a("div",j,[n(g,{modelValue:s.formData.new_password,"onUpdate:modelValue":t[1]||(t[1]=i=>s.formData.new_password=i),textLength:s.validationRules.password.max,isPassword:!0,inputErrors:s.state.formErrors.new_password,labelText:s.$t("settings.forms.password_settings.new_password"),placeholder:s.$t("settings.forms.password_settings.password_placeholder")},{feedbackInfo:d(()=>[w(_(s.$t("settings.forms.password_settings.new_password_helper")),1)]),_:1},8,["modelValue","textLength","inputErrors","labelText","placeholder"])]),a("div",A,[n(T,{loading:s.state.isGenerating,onClick:s.generatePassword,iconPosition:"left",buttonType:"button",buttonText:s.$t("settings.forms.password_settings.generate_password")},{buttonIcon:d(()=>[n(b,{name:"star-06",type:"solid",classes:"size-full text-brand-900"})]),_:1},8,["loading","onClick","buttonText"])]),a("div",R,[n(h,{iconName:"hand",modelValue:s.formData.logout_other_devices,"onUpdate:modelValue":t[2]||(t[2]=i=>s.formData.logout_other_devices=i),titleText:s.$t("labels.security")},{captionText:d(()=>[a("span",{innerHTML:s.$t("settings.forms.password_settings.security_helper")},null,8,U)]),_:1},8,["modelValue","titleText"])]),a("div",O,[n(v,{loading:s.state.isSubmitting,buttonType:"submit",buttonText:s.$t("labels.save_changes")},null,8,["loading","buttonText"])])],32)]))],64)}const es=y(F,[["render",J]]);export{es as default};
