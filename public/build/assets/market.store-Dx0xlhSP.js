import{u as a}from"./vendor-20TtR0Rd.js";import{c as r}from"./global.properties-DKM1fd6s.js";const u=a("marketplace",{state:()=>({categories:[],products:[],filter:{},product:null,metadata:{},bookmarkedProducts:[]}),getters:{activeFiltersCount:function(){let t=0;return Object.keys(this.filter).length&&(this.filter.query&&t++,this.filter.category_id&&t++,(this.filter.price.from||this.filter.price.to)&&t++,this.filter.is_store&&t++,this.filter.with_discount&&t++,this.filter.high_rating&&t++,Object.keys(this.filter.currencies).find(i=>this.filter.currencies[i]===!0)&&t++,Object.keys(this.filter.conditions).find(i=>this.filter.conditions[i]===!0)&&t++,Object.keys(this.filter.types).find(i=>this.filter.types[i]===!0)&&t++),t}},actions:{getLastProductId:function(){return this.products.length?this.products[this.products.length-1].id:null},makeLoadRequest:async function(){return await r().marketplace().with({filter:this.filter}).sendTo("products")},fetchProducts:async function(){await this.makeLoadRequest().then(t=>{this.products=t.data.data}).catch(t=>{this.products=[]})},fetchBookmarkedProducts:async function(){await r().marketplace().getFrom("bookmarks").then(t=>{this.bookmarkedProducts=t.data.data}).catch(t=>{this.bookmarkedProducts=[]})},loadMoreProducts:async function(){return await this.makeLoadRequest().then(t=>{let e=t.data.data;return e.length?(this.products=this.products.concat(e),!0):!1}).catch(t=>!1)},fetchProduct:async function(t){if(this.product&&this.product.id==t)return!1;await r().marketplace().getFrom(`products/${t}`).then(e=>{this.product=e.data.data}).catch(e=>{})},fetchCategories:async function(){this.categories.length||await r().marketplace().getFrom("categories").then(t=>{this.categories=t.data.data}).catch(t=>{t.response&&console.error(t.response.data.message)})},bookmarkProduct:async function(t){return await r().marketplace().with({id:t}).sendTo("bookmarks/add")},fetchMetadata:async function(){if(Object.keys(this.metadata).length)return!1;this.filter=this.getFilterSchema(),await r().marketplace().getFrom("metadata").then(t=>{this.metadata=t.data.data}).catch(t=>{})},resetFilter:function(){this.filter=this.getFilterSchema()},getFilterSchema:function(){return{query:"",category_id:null,price:{from:"",to:""},is_store:!1,with_discount:!1,high_rating:!1,conditions:{},currencies:{},types:{},cursor:null}}}});export{u};
