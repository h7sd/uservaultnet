import{T as A,u as I}from"./TimelinePublication-CYGP9Mfq.js";import{u as M}from"./index-DABlbPqL.js";import{u as z}from"./index-Dl0ZWYHh.js";import{_ as C,d as S,r as a,c as i,o as s,j as o,m,a as d,t as y,F as f,i as k,w as F,n as B,b,h as P,B as $,e as w,g as N,G as R}from"./global.properties-ieI6Xwik.js";import{T as D}from"./TimelinePublicationSkeleton-BlliYZGM.js";import{T as j}from"./TimelineContainer-Cj8RYrtQ.js";import{f as V,c as E}from"./application-B35z453N.js";import{r as G}from"./swiper-element-bundle-DBu82uhE.js";import{A as H}from"./AvatarMedium-DjxMcVIA.js";import{A as q}from"./AdCard-eGzQ-765.js";import{F as J,a as K}from"./FeedUpdate-CZH1Bkk9.js";import"./AvatarRightSided-DIsCtZes.js";import"./index-DyH4rDzV.js";import"./mention.plugin-6T_AP_1M.js";import"./index-CZvQntMR.js";import"./ProgressiveImageLoader-DUluSfqC.js";import"./SpinnerIcon-D3U9frcO.js";import"./media.status-D6lx-p4W.js";import"./index-Dun6B87D.js";import"./VideoDurationTime-CY2-hNg2.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./GiphyAttribution-Cv2rUDbj.js";import"./DropdownButton-b5Hfnztp.js";import"./LinkSnapshot-CKRJS_OO.js";import"./LinkSnapshot-D9dLwJZT.js";import"./ViewsCounter-7KyRmWQv.js";import"./AvatarExtraSmall-Cf0UikId.js";import"./SheetTitle-Cb1vf6Xi.js";import"./TimelineEmptyState-D2cMbIuH.js";import"./index-CaocF3Et.js";import"./PeopleListItem-q67tTG6c.js";G();const O=S({setup:function(){const e=V(),n=E(),c=b(()=>n.userData);return P(async()=>{try{await e.fetchStoriesFeed()}catch{}}),{storiesFeed:b(()=>e.storiesFeed),userData:c,createStory:()=>{$.emit("story:create")}}},components:{AvatarMedium:H}}),Q={class:"max-w-full"},W={"slides-per-view":"auto","space-between":"12",speed:"200",mousewheel:"true","grab-cursor":"true",class:"w-full"},X={class:"w-[80px] shrink-0"},Y={class:"relative mb-1 w-[80px] p-1"},Z={class:"rounded-full border-3 border-bg-pr overflow-hidden inline-flex-center size-6 bg-lab-pr2 absolute bottom-1 -right-0.5 z-10"},ee={class:"rounded-full overflow-hidden"},te=["src"],oe={class:"text-par-s text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"},se={class:"shrink-0 w-[80px]"},ie={key:0,class:"absolute inset-0"},ne=["src"],re={class:"suze-full rounded-full overflow-hidden"},ae=["src"],le={class:"text-par-s text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"};function de(e,n,c,h,r,v){const l=a("SvgIcon"),u=a("RouterLink");return s(),i("div",Q,[o("swiper-container",W,[o("swiper-slide",X,[o("div",{onClick:n[0]||(n[0]=(...t)=>e.createStory&&e.createStory(...t)),class:"block w-[80px] cursor-pointer shrink-0"},[o("div",Y,[o("div",Z,[d(l,{name:"plus",classes:"text-bg-pr size-4"})]),o("div",ee,[o("img",{class:"size-full",src:e.userData.avatar_url,alt:"Avatar"},null,8,te)])]),o("div",oe,y(e.$t("labels.new_story")),1)])]),e.storiesFeed.length?(s(!0),i(f,{key:0},k(e.storiesFeed,t=>(s(),i("swiper-slide",{key:t.story_uuid,class:"w-[80px] shrink-0"},[d(u,{to:{name:"stories_index",params:{story_uuid:t.story_uuid}}},{default:F(()=>[o("div",se,[o("div",{class:B(["size-[80px] rounded-full border-2 p-[3px]",[t.is_owner||t.is_seen?"border-bord-card":""]])},[!t.is_seen&&!t.is_owner?(s(),i("div",ie,[o("img",{src:e.$asset("assets/avatars/story-avatar-ring.png"),alt:"Image"},null,8,ne)])):m("",!0),o("div",re,[o("img",{class:"size-full object-cover inline-block bg-fill-pr",src:t.relations.user.avatar_url,alt:"Image"},null,8,ae)])],2),o("div",le,y(t.relations.user.name),1)])]),_:2},1032,["to"])]))),128)):m("",!0)])])}const ce=C(O,[["render",de]]),pe=S({setup:function(){const e=N({isLoading:!1,isLoadingContent:!1,noMoreContent:!1,isUpdating:!1,filter:{page:1}});let n=null,c=0;const{postDeleter:h}=M(),r=I(),v=b(()=>r.update),l=b(()=>r.posts);return P(async()=>{e.isLoading=!0,l.value.length?e.isLoading=!1:(await r.initialLoad(),e.isLoading=!1,n=setInterval(async()=>{e.isUpdating||(v.value.length==0&&c>10?clearInterval(n):(e.isUpdating=!0,await r.updateFeed(),e.isUpdating=!1,c++))},60*1e3*10))}),R(()=>{n&&clearInterval(n)}),z({callback:async()=>{try{!e.isLoadingContent&&!e.noMoreContent&&l.value.length&&(e.isLoadingContent=!0,await r.loadNextPage().then(function(t){let p=t.data.data;p.length?r.appendPosts(p):e.noMoreContent=!0}).catch(t=>{t.response&&(e.noMoreContent=!0)}),e.isLoadingContent=!1)}catch(t){console.log(t)}}}),{timelinePosts:l,state:e,timelineNewPosts:v,handlePostDelete:t=>{h(t,p=>{$.emit("timeline:post-deleted",p),toastSuccess(__t("toast.media.post_deleted"))})},applyTimelineUpdate:()=>{r.applyUpdate()}}},components:{TimelinePublication:A,TimelinePublicationSkeleton:D,TimelineContainer:j,StoriesFeed:ce,AdCard:q,FollowRecommendation:K,FeedUpdate:J}}),me={class:"px-4 pb-3 pt-1"},ue={key:0},_e={key:1,class:"pb-6"},fe={key:1},he={key:0},ve={key:2},ge={class:"py-32"},we={class:"text-lab-sc text-par-s text-center"};function be(e,n,c,h,r,v){const l=a("StoriesFeed"),u=a("Border"),t=a("TimelinePublicationSkeleton"),p=a("FeedUpdate"),T=a("TimelinePublication"),L=a("FollowRecommendation"),x=a("AdCard"),U=a("TimelineContainer");return s(),w(U,null,{default:F(()=>[o("div",me,[d(l)]),d(u,{height:"h-2",opacity:"opacity-30"}),e.state.isLoading?(s(),i("div",ue,[(s(),i(f,null,k(2,_=>d(t,{key:_})),64))])):(s(),i("div",_e,[e.timelineNewPosts.length?(s(),w(p,{key:0,posts:e.timelineNewPosts,onClick:e.applyTimelineUpdate},null,8,["posts","onClick"])):m("",!0),e.timelinePosts.length?(s(),i("div",fe,[(s(!0),i(f,null,k(e.timelinePosts,(_,g)=>(s(),i(f,{key:_.hash_id},[d(T,{postData:_,onDelete:ye=>e.handlePostDelete(_)},null,8,["postData","onDelete"]),(g+1)%35===0?(s(),w(L,{key:g})):m("",!0),(g+1)%10===0?(s(),i(f,{key:1},[(s(),w(x,{key:g})),d(u,{height:"h-2",opacity:"opacity-30"})],64)):m("",!0)],64))),128)),e.state.isLoadingContent?(s(),i("div",he,n[0]||(n[0]=[o("div",{class:"flex justify-center my-4"},[o("div",{class:"colibri-primary-animation"})],-1)]))):m("",!0)])):(s(),i("div",ve,[o("div",ge,[o("p",we,y(e.$t("empty_state.home.posts")),1)])]))]))]),_:1})}const Ze=C(pe,[["render",be]]);export{Ze as default};
