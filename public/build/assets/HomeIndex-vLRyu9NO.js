import{s as z,t as E,d as M,P as U,n as G,o as x,A as j,m as V}from"./application-DnsIlr-S.js";import{k as q,l as J,_ as y,d as C,c as r,j as o,m as v,a as t,r as n,t as w,F as P,i as S,b,h as F,o as s,w as _,n as K,B as T,e as $,v as O,u as Q,x as W,g as L,M as X,G as Y}from"./global.properties-ieI6Xwik.js";import{u as Z}from"./index-DABlbPqL.js";import{u as ee}from"./index-Dl0ZWYHh.js";import{r as te}from"./swiper-element-bundle-DBu82uhE.js";import{A as oe}from"./AvatarMedium-BDR98hYM.js";import{T as ne}from"./TimelinePublication-Cg7erd3h.js";import{T as se}from"./TimelinePublicationSkeleton-BKOwceKg.js";import{S as ie,A as ae,T as re}from"./AdGridItem-DIuPUQRu.js";import{S as le}from"./ScrollTopButton-g6R9lYqi.js";import{F as ce}from"./FollowRecommendationList-BYFEBsjn.js";import{P as de}from"./PageHeader-BUJw24wb.js";import{F as ue}from"./FeedUpdate-BDou7I4a.js";import"./inbox.store-DKf8FrGP.js";import"./index-CaocF3Et.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./TranslationService-ew0KueNY.js";import"./ViewsCounter-7KyRmWQv.js";import"./PublicationQuote-1qpVpjjc.js";import"./AvatarExtraSmall-CzXHXk-G.js";import"./ProgressiveImageLoader-DUluSfqC.js";import"./SpinnerIcon-D3U9frcO.js";import"./VideoDurationTime-CY2-hNg2.js";const pe=q("pins_store",{deleteAware:!0,state:function(){return{posts:[]}},actions:{fetchGlobalPins:function(){J().pins().getFrom("posts/global").then(e=>{this.posts=e.data.data}).catch(e=>{this.posts=[]})}}});te();const me=C({setup:function(){const e=z(),i=E(),h=M(),f=b(()=>h.userData);return F(async()=>{try{await i.fetchStoriesFeed()}catch{}}),{storiesFeed:b(()=>i.storiesFeed),userData:f,createStory:()=>{e.openEditor()}}},components:{AvatarMedium:oe}}),_e={class:"max-w-full"},he={"slides-per-view":"auto","space-between":"12",speed:"200",mousewheel:"true","grab-cursor":"true",class:"w-full"},fe={class:"w-[74px] shrink-0"},ge={class:"size-[74px] relative p-1"},ve={class:"size-full rounded-full overflow-hidden"},be=["src"],ke={class:"border-3 border-bg-pr rounded-full inline-flex-center text-bg-pr size-icon-normal bg-lab-pr2 absolute bottom-0.5 right-0.5 z-10"},Pe={class:"text-par-s font-medium text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"},Se={key:0,class:"absolute inset-0"},$e=["src"],we={class:"rounded-full size-full overflow-hidden"},ye=["src"],Ce={class:"text-par-s font-medium text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"};function Ie(e,i,h,f,c,g){const u=n("SvgIcon"),l=n("RouterLink");return s(),r("div",_e,[o("swiper-container",he,[o("swiper-slide",fe,[o("div",{onClick:i[0]||(i[0]=(...a)=>e.createStory&&e.createStory(...a)),class:"w-[74px] cursor-pointer"},[o("div",ge,[o("div",ve,[o("img",{class:"size-full inline-block bg-fill-pr",src:e.userData.avatar_url,alt:"Image"},null,8,be)]),o("div",ke,[t(u,{name:"plus"})])]),o("div",Pe,w(e.$t("labels.new_story")),1)])]),e.storiesFeed.length?(s(!0),r(P,{key:0},S(e.storiesFeed,a=>(s(),r("swiper-slide",{key:a.story_uuid,class:"w-[74px] shrink-0"},[t(l,{to:{name:"stories_index",params:{story_uuid:a.story_uuid}}},{default:_(()=>[o("div",{class:K(["size-[74px] rounded-full border-2 p-[3px]",[a.is_owner||a.is_seen?"border-bord-card":""]])},[!a.is_seen&&!a.is_owner?(s(),r("div",Se,[o("img",{src:e.$asset("assets/avatars/story-avatar-ring.png"),alt:"Image"},null,8,$e)])):v("",!0),o("div",we,[o("img",{class:"size-full inline-block bg-fill-pr",src:a.relations.user.avatar_url,alt:"Image"},null,8,ye)])],2),o("div",Ce,w(a.relations.user.name),1)]),_:2},1032,["to"])]))),128)):v("",!0)])])}const Te=y(me,[["render",Ie]]),Me=C({setup:function(){return{openPostEditorModal:()=>{T.emit("post-editor:open")}}}}),Fe={class:"text-par-l gap-2.5"};function Le(e,i,h,f,c,g){const u=n("SvgIcon");return s(),r("div",{class:"cursor-pointer flex text-lab-pr2 items-center py-3.5 justify-center gap-2",onClick:i[0]||(i[0]=(...l)=>e.openPostEditorModal&&e.openPostEditorModal(...l))},[o("span",Fe,w(e.$t("editor.post_text_input_placeholder")),1),t(u,{name:"pencil-line",type:"line",classes:"size-4"})])}const Be=y(Me,[["render",Le]]),Ae=C({setup:function(){const e=M();return{state:L({mainMenu:X()}),userData:b(()=>e.userData),openAccountSwitcherModal:()=>{T.emit("account-switcher:open")}}},components:{PageHeader:de,AvatarSmall:j,RichMenu:x,RichMenuItem:G,PrimaryIconButton:U}}),Ne={class:"relative"},Re={class:"opacity-80 hover:opacity-100 translate-x-1"},De={key:0,class:"absolute top-full right-0 w-96 z-50"};function He(e,i,h,f,c,g){const u=n("PrimaryIconButton"),l=n("RichMenuItem"),a=n("RouterLink"),k=n("Border"),d=n("RichMenu"),p=n("PageHeader"),I=W("outside-click");return s(),$(p,{titleText:e.$t("labels.hello_user",{name:e.userData.first_name})},{default:_(()=>[o("div",Ne,[o("div",Re,[t(u,{onClick:Q(e.state.mainMenu.open,["stop"]),iconSize:"icon-normal",iconName:"chevron-down",buttonColor:"text-lab-sc"},null,8,["onClick"])]),e.state.mainMenu.status?O((s(),r("div",De,[t(d,null,{default:_(()=>[t(l,{onClick:e.openAccountSwitcherModal,title:e.userData.name,description:e.$t("labels.nav_menu.switch_account.description"),trailingIconName:"user-01",avatarSrc:e.userData.avatar_url},null,8,["onClick","title","description","avatarSrc"]),t(a,{to:{name:"settings_theme"},class:"block"},{default:_(()=>[t(l,{title:e.$t("labels.nav_menu.theme.title"),description:e.$t("labels.nav_menu.theme.description"),trailingIconName:"arrow-up-right",iconName:"moon-02"},null,8,["title","description"])]),_:1}),t(a,{to:{name:"settings_language"},class:"block"},{default:_(()=>[t(l,{title:e.$t("labels.nav_menu.language.title"),description:e.$t("labels.nav_menu.language.description"),iconType:"line",trailingIconName:"arrow-up-right",iconName:"translate-01"},null,8,["title","description"])]),_:1}),t(k),t(a,{to:{name:"bookmarks_index"},class:"block"},{default:_(()=>[t(l,{title:e.$t("labels.nav_menu.bookmarks.title"),description:e.$t("labels.nav_menu.bookmarks.description"),iconType:"solid",trailingIconName:"arrow-up-right",iconName:"bookmark"},null,8,["title","description"])]),_:1})]),_:1})])),[[I,e.state.mainMenu.close]]):v("",!0)])]),_:1},8,["titleText"])}const ze=y(Ae,[["render",He]]),Ee=C({setup:function(){const e=L({isLoading:!1,isLoadingContent:!1,noMoreContent:!1,isUpdating:!1,filter:{page:1}});let i=null,h=0;const{postDeleter:f}=Z(),c=V(),g=pe(),u=b(()=>c.update),l=b(()=>c.posts),a=b(()=>g.posts);return F(async()=>{e.isLoading=!0,await c.initialLoad(),g.fetchGlobalPins(),e.isLoading=!1,l.value.length&&(i=setInterval(async()=>{e.isUpdating||(u.value.length==0&&h>10?clearInterval(i):(e.isUpdating=!0,await c.updateFeed(),e.isUpdating=!1,h++))},60*1e3*10))}),Y(()=>{i&&clearInterval(i)}),ee({callback:async()=>{try{!e.isLoadingContent&&!e.noMoreContent&&l.value.length&&(e.isLoadingContent=!0,await c.loadNextPage().then(function(d){let p=d.data.data;p.length?c.appendPosts(p):e.noMoreContent=!0}).catch(d=>{d.response&&(e.noMoreContent=!0)}),e.isLoadingContent=!1)}catch(d){console.log(d)}}}),{timelinePosts:l,state:e,timelineNewPosts:u,globalPinnedPosts:a,handlePostDelete:d=>{f(d,p=>{T.emit("timeline:post-deleted",p)})},applyTimelineUpdate:()=>{c.applyUpdate()}}},components:{StoriesFeed:Te,TimelinePublication:ne,PublicationEditorTrigger:Be,TimelinePublicationSkeleton:se,TimelineContainer:re,FollowRecommendationList:ce,AdGridItem:ae,ScrollTopButton:le,HomeHeader:ze,SidedContentLayout:ie,FeedUpdate:ue}}),Ue={key:0,class:"block"},Ge={key:1,class:"block"},xe={class:"pb-4 px-4"},je={class:"block"},Ve={key:2},qe={key:0},Je={key:3},Ke={class:"block py-72"},Oe={class:"text-lab-sc text-par-s text-center"};function Qe(e,i,h,f,c,g){const u=n("HomeHeader"),l=n("TimelinePublicationSkeleton"),a=n("StoriesFeed"),k=n("Border"),d=n("PublicationEditorTrigger"),p=n("TimelinePublication"),I=n("FeedUpdate"),B=n("TimelineContainer"),A=n("FollowRecommendationList"),N=n("AdGridItem"),R=n("SidedContentLayout"),D=n("ScrollTopButton");return s(),r(P,null,[t(R,null,{content:_(()=>[t(B,null,{default:_(()=>[t(u),e.state.isLoading?(s(),r("div",Ue,[(s(),r(P,null,S(3,m=>t(l,{key:m})),64))])):(s(),r("div",Ge,[o("div",xe,[t(a)]),t(k),o("div",je,[t(d)]),t(k),e.globalPinnedPosts.length?(s(!0),r(P,{key:0},S(e.globalPinnedPosts,m=>(s(),$(p,{postData:m,isPinned:!0,onDelete:H=>e.handlePostDelete(m),key:m.hash_id},null,8,["postData","onDelete"]))),128)):v("",!0),e.timelineNewPosts.length?(s(),$(I,{key:1,posts:e.timelineNewPosts,onClick:e.applyTimelineUpdate},null,8,["posts","onClick"])):v("",!0),e.timelinePosts.length?(s(),r("div",Ve,[(s(!0),r(P,null,S(e.timelinePosts,m=>(s(),$(p,{postData:m,onDelete:H=>e.handlePostDelete(m),key:m.hash_id},null,8,["postData","onDelete"]))),128)),e.state.isLoadingContent?(s(),r("div",qe,i[0]||(i[0]=[o("div",{class:"flex justify-center my-4"},[o("div",{class:"colibri-primary-animation"})],-1)]))):v("",!0)])):(s(),r("div",Je,[o("div",Ke,[o("p",Oe,w(e.$t("empty_state.home.posts")),1)])]))]))]),_:1})]),sidebar:_(()=>[t(A),t(N)]),_:1}),t(D)],64)}const bt=y(Ee,[["render",Qe]]);export{bt as default};
