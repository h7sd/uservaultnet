import{T as A,u as I}from"./TimelinePublication-CgCo0Ypy.js";import{u as M}from"./index-CA1Yx5qL.js";import{u as z}from"./index-B5kc-12x.js";import{_ as C,b as S}from"./global.properties-DKM1fd6s.js";import{T as N}from"./TimelinePublicationSkeleton-BC-OysGh.js";import{T as B}from"./TimelineContainer-DF9R5tCB.js";import{f as R,c as D}from"./application-C3zsOS77.js";import{r as j}from"./swiper-element-bundle-DBu82uhE.js";import{A as V}from"./AvatarMedium-DdPpxRFI.js";import{k as F,e as a,c as i,d as s,s as o,v as m,i as d,t as y,F as f,f as k,q as P,j as E,l as w,o as $,p as b,b as q,G}from"./vendor-20TtR0Rd.js";import{A as H}from"./AdCard-D48AMbS6.js";import{F as J,a as K}from"./FeedUpdate-B6nOyACT.js";import"./AvatarRightSided-DB-VHCky.js";import"./index-DyH4rDzV.js";import"./mention.plugin-6T_AP_1M.js";import"./editor-CpZ7vO5P.js";import"./index-CZvQntMR.js";import"./ProgressiveImageLoader-8evwBPct.js";import"./SpinnerIcon-BFpWBik4.js";import"./media.status-D6lx-p4W.js";import"./index-DvUAJ3ty.js";import"./VideoDurationTime-DjdOjCKw.js";import"./media-D4ZD3EDk.js";import"./GiphyAttribution-79F8UUld.js";import"./DropdownButton-CQ32lbq7.js";import"./LinkSnapshot-C_DWeP4J.js";import"./LinkSnapshot-C0Z1Turo.js";import"./ViewsCounter-DDf6U7Tj.js";import"./AvatarExtraSmall-CURibG5K.js";import"./SheetTitle-CCLXWnJ3.js";import"./TimelineEmptyState-D4R0nEYT.js";import"./index-ciglwFMH.js";import"./PeopleListItem-DOFLjTB9.js";j();const O=F({setup:function(){const e=R(),n=D(),c=w(()=>n.userData);return $(async()=>{try{await e.fetchStoriesFeed()}catch{}}),{storiesFeed:w(()=>e.storiesFeed),userData:c,createStory:()=>{S.emit("story:create")}}},components:{AvatarMedium:V}}),Q={class:"max-w-full"},W={"slides-per-view":"auto","space-between":"12",speed:"200",mousewheel:"true","grab-cursor":"true",class:"w-full"},X={class:"w-[80px] shrink-0"},Y={class:"relative mb-1 w-[80px] p-1"},Z={class:"rounded-full border-3 border-bg-pr overflow-hidden inline-flex-center size-6 bg-lab-pr2 absolute bottom-1 -right-0.5 z-10"},ee={class:"rounded-full overflow-hidden"},te=["src"],oe={class:"text-par-s text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"},se={class:"shrink-0 w-[80px]"},ie={key:0,class:"absolute inset-0"},ne=["src"],re={class:"suze-full rounded-full overflow-hidden"},ae=["src"],le={class:"text-par-s text-lab-pr text-center whitespace-nowrap overflow-hidden text-ellipsis"};function de(e,n,c,h,r,v){const l=a("SvgIcon"),u=a("RouterLink");return s(),i("div",Q,[o("swiper-container",W,[o("swiper-slide",X,[o("div",{onClick:n[0]||(n[0]=(...t)=>e.createStory&&e.createStory(...t)),class:"block w-[80px] cursor-pointer shrink-0"},[o("div",Y,[o("div",Z,[d(l,{name:"plus",classes:"text-bg-pr size-4"})]),o("div",ee,[o("img",{class:"size-full",src:e.userData.avatar_url,alt:"Avatar"},null,8,te)])]),o("div",oe,y(e.$t("labels.new_story")),1)])]),e.storiesFeed.length?(s(!0),i(f,{key:0},k(e.storiesFeed,t=>(s(),i("swiper-slide",{key:t.story_uuid,class:"w-[80px] shrink-0"},[d(u,{to:{name:"stories_index",params:{story_uuid:t.story_uuid}}},{default:P(()=>[o("div",se,[o("div",{class:E(["size-[80px] rounded-full border-2 p-[3px]",[t.is_owner||t.is_seen?"border-bord-card":""]])},[!t.is_seen&&!t.is_owner?(s(),i("div",ie,[o("img",{src:e.$asset("assets/avatars/story-avatar-ring.png"),alt:"Image"},null,8,ne)])):m("",!0),o("div",re,[o("img",{class:"size-full object-cover inline-block bg-fill-pr",src:t.relations.user.avatar_url,alt:"Image"},null,8,ae)])],2),o("div",le,y(t.relations.user.name),1)])]),_:2},1032,["to"])]))),128)):m("",!0)])])}const ce=C(O,[["render",de]]),pe=F({setup:function(){const e=q({isLoading:!1,isLoadingContent:!1,noMoreContent:!1,isUpdating:!1,filter:{page:1}});let n=null,c=0;const{postDeleter:h}=M(),r=I(),v=w(()=>r.update),l=w(()=>r.posts);return $(async()=>{e.isLoading=!0,l.value.length?e.isLoading=!1:(await r.initialLoad(),e.isLoading=!1,n=setInterval(async()=>{e.isUpdating||(v.value.length==0&&c>10?clearInterval(n):(e.isUpdating=!0,await r.updateFeed(),e.isUpdating=!1,c++))},60*1e3*10))}),G(()=>{n&&clearInterval(n)}),z({callback:async()=>{try{!e.isLoadingContent&&!e.noMoreContent&&l.value.length&&(e.isLoadingContent=!0,await r.loadNextPage().then(function(t){let p=t.data.data;p.length?r.appendPosts(p):e.noMoreContent=!0}).catch(t=>{t.response&&(e.noMoreContent=!0)}),e.isLoadingContent=!1)}catch(t){console.log(t)}}}),{timelinePosts:l,state:e,timelineNewPosts:v,handlePostDelete:t=>{h(t,p=>{S.emit("timeline:post-deleted",p),toastSuccess(__t("toast.media.post_deleted"))})},applyTimelineUpdate:()=>{r.applyUpdate()}}},components:{TimelinePublication:A,TimelinePublicationSkeleton:N,TimelineContainer:B,StoriesFeed:ce,AdCard:H,FollowRecommendation:K,FeedUpdate:J}}),me={class:"px-4 pb-3 pt-1"},ue={key:0},_e={key:1,class:"pb-6"},fe={key:1},he={key:0},ve={key:2},ge={class:"py-32"},be={class:"text-lab-sc text-par-s text-center"};function we(e,n,c,h,r,v){const l=a("StoriesFeed"),u=a("Border"),t=a("TimelinePublicationSkeleton"),p=a("FeedUpdate"),T=a("TimelinePublication"),L=a("FollowRecommendation"),x=a("AdCard"),U=a("TimelineContainer");return s(),b(U,null,{default:P(()=>[o("div",me,[d(l)]),d(u,{height:"h-2",opacity:"opacity-30"}),e.state.isLoading?(s(),i("div",ue,[(s(),i(f,null,k(2,_=>d(t,{key:_})),64))])):(s(),i("div",_e,[e.timelineNewPosts.length?(s(),b(p,{key:0,posts:e.timelineNewPosts,onClick:e.applyTimelineUpdate},null,8,["posts","onClick"])):m("",!0),e.timelinePosts.length?(s(),i("div",fe,[(s(!0),i(f,null,k(e.timelinePosts,(_,g)=>(s(),i(f,{key:_.hash_id},[d(T,{postData:_,onDelete:ye=>e.handlePostDelete(_)},null,8,["postData","onDelete"]),(g+1)%35===0?(s(),b(L,{key:g})):m("",!0),(g+1)%10===0?(s(),i(f,{key:1},[(s(),b(x,{key:g})),d(u,{height:"h-2",opacity:"opacity-30"})],64)):m("",!0)],64))),128)),e.state.isLoadingContent?(s(),i("div",he,n[0]||(n[0]=[o("div",{class:"flex justify-center my-4"},[o("div",{class:"colibri-primary-animation"})],-1)]))):m("",!0)])):(s(),i("div",ve,[o("div",ge,[o("p",be,y(e.$t("empty_state.home.posts")),1)])]))]))]),_:1})}const tt=C(pe,[["render",we]]);export{tt as default};
