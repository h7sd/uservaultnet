import{k as T,c as u,s as o,i as l,e as m,t as g,q as y,y as S,F as P,r as c,b as D,o as E,l as $,H as k,d as p,x as V}from"./vendor-20TtR0Rd.js";import{a as B,f as x,d as F}from"./application-DEz9sPnz.js";import{_ as I,c as _}from"./global.properties-DKM1fd6s.js";import{T as w}from"./TextInput-Bad2IYlx.js";import{S as L}from"./SectionToggle-BmUma1X-.js";import"./inbox.store-CHx7CB4w.js";import"./index-ciglwFMH.js";import"./ui-Bp8YvxdW.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";const A=T({setup:function(){const e=F(),a=c(e.userData),d=c({}),f=k(),s=D({isLoading:!0,isSubmitting:!1,formErrors:{email:[]}}),r=c({email:a.value.email,email_privacy:!0});return E(async()=>{await _().userSettings().getFrom("email/settings").then(t=>{let i=t.data.data;d.value=i.validation_rules,r.value.email=i.email,r.value.email_privacy=i.privacy_settings.email_privacy}),s.isLoading=!1}),{formData:r,validationRules:d,state:s,submitForm:async()=>{s.isSubmitting===!1&&(s.isSubmitting=!0,Object.keys(s.formErrors).forEach(t=>{s.formErrors[t]=[]}),await _().userSettings().with(r.value).putTo("email/update").then(t=>{t.data.data.confirmation_required?f.push({name:"settings_email_confirm"}):toastSuccess(__t("toast.forms.changes_saved"))}).catch(t=>{t.response&&(toastError(t.response.data.message),t.response.data.errors&&Object.keys(t.response.data.errors).forEach(i=>{s.formErrors[i]=t.response.data.errors[i]}))}),s.isSubmitting=!1)},isSubmitDenied:$(()=>!1)}},components:{PrimaryPillButton:x,TextInput:w,PageTitle:B,SectionToggle:L}}),N={class:"mb-8"},R={key:0,class:"block"},C={class:"mb-8"},j={class:"text-par-m text-lab-sc"},q={class:"mb-10"},M={class:"mb-10"},O={class:"block mb-16"},U={key:1,class:"block"},H={class:"flex-center h-96"};function z(e,a,d,f,s,r){const t=m("PageTitle"),i=m("TextInput"),b=m("SectionToggle"),v=m("PrimaryPillButton"),h=m("PrimarySpinAnimation");return p(),u(P,null,[o("div",N,[l(t,{hasBack:!0,titleText:e.$t("settings.email_settings")},null,8,["titleText"])]),e.state.isLoading?(p(),u("div",U,[o("div",H,[l(h)])])):(p(),u("div",R,[o("div",C,[o("h6",j,g(e.$t("settings.forms.email_address.page_desc")),1)]),o("form",{onSubmit:a[2]||(a[2]=S((...n)=>e.submitForm&&e.submitForm(...n),["prevent"]))},[o("div",q,[l(i,{textLength:e.validationRules.email.max,modelValue:e.formData.email,"onUpdate:modelValue":a[0]||(a[0]=n=>e.formData.email=n),inputErrors:e.state.formErrors.email,labelText:e.$t("settings.forms.email_address.email_address"),placeholder:e.$t("settings.forms.email_address.email_address_placeholder")},{feedbackInfo:y(()=>[V(g(e.$t("settings.forms.email_address.email_address_helper")),1)]),_:1},8,["textLength","modelValue","inputErrors","labelText","placeholder"])]),o("div",M,[l(b,{iconName:"shield-01",modelValue:e.formData.email_privacy,"onUpdate:modelValue":a[1]||(a[1]=n=>e.formData.email_privacy=n),captionText:e.$t("settings.forms.email_address.privacy_helper"),titleText:e.$t("labels.privacy")},null,8,["modelValue","captionText","titleText"])]),o("div",O,[l(v,{isDisabled:e.isSubmitDenied,loading:e.state.isSubmitting,buttonType:"submit",buttonText:e.$t("labels.save_changes")},null,8,["isDisabled","loading","buttonText"])])],32)]))],64)}const se=I(A,[["render",z]]);export{se as default};
