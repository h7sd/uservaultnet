import{k as P,c as i,d as s,s as o,e as a,t as F,j as L,i as t,h as W,v as C,b as M,q as c,F as k,f as B,l as $,p as v,z as R,y as E,A as U,r as T,o as X,G as Y,w as Z}from"./vendor-20TtR0Rd.js";import{u as H}from"./market.store-Dx0xlhSP.js";import{u as x}from"./index-B5kc-12x.js";import{_ as S,d as q}from"./global.properties-DKM1fd6s.js";import{A as ee,T as te,S as oe}from"./AdGridItem-Caaf0ZJU.js";import{P as ne}from"./ProductCard-Ch4mRau5.js";import{C as ae}from"./CategoriesFilter-ass-G6-c.js";import{S as le}from"./SearchBar-ljxjEWz7.js";import{T as I}from"./TextInput-Bad2IYlx.js";import{S as re,n as se,o as ie,P as A,k as de,g as ce,B as ue,f as pe}from"./application-DEz9sPnz.js";import{F as me}from"./FluidEmptyState-DExNov7G.js";import{P as fe}from"./PageHeader-DKtQQhA9.js";import{F as _e}from"./FollowRecommendationList-UjQQknis.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./inbox.store-CHx7CB4w.js";import"./index-ciglwFMH.js";import"./ui-Bp8YvxdW.js";const he=P({props:{label:{type:String,default:""},name:{type:String,default:""},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,n){return{uniqueId:Math.random().toString(36).substring(7),updateModelValue:u=>{n.emit("update:modelValue",u.target.checked)}}}}),ke={class:"block"},ye={class:"flex items-center cursor-pointer"},be=["id","checked","name"],ge=["for","innerHTML"];function ve(e,n,u,r,b,g){return s(),i("div",ke,[o("div",ye,[o("input",{id:e.uniqueId,checked:e.modelValue,onChange:n[0]||(n[0]=(...p)=>e.updateModelValue&&e.updateModelValue(...p)),type:"checkbox",name:e.name,class:"size-icon-small bg-transparent border-2 border-edge-pr rounded-lg focus:ring-brand-900"},null,40,be),o("label",{for:e.uniqueId,innerHTML:e.label,class:"ms-2 cursor-pointer text-par-s font-medium text-lab-pr2 flex-1"},null,8,ge)])])}const $e=S(he,[["render",ve]]),Ce=P({props:{title:{type:String,default:""},caption:{type:String,default:""},isExpanded:{type:Boolean,default:!1}},setup:function(e){const n=M({isExpanded:e.isExpanded});return{state:n,toggle:()=>{n.isExpanded=!n.isExpanded}}}}),Pe={class:"px-4"},Se={class:"block py-3"},Ve={class:"flex-1"},Be={class:"text-par-n font-medium text-lab-pr2"},Fe={class:"shrink-0"},Me={key:0,class:"mt-2"},we=["innerHTML"];function Le(e,n,u,r,b,g){const p=a("SvgIcon");return s(),i("div",Pe,[o("div",Se,[o("div",{class:"mb-0 flex justify-between items-center cursor-pointer",onClick:n[0]||(n[0]=(...d)=>e.toggle&&e.toggle(...d))},[o("div",Ve,[o("h5",Be,F(e.title),1)]),o("div",Fe,[o("button",{class:L(["size-icon-normal text-lab-tr outline-hidden leading-zero hover:text-brand-900 smoothing",[e.state.isExpanded?"":"rotate-180"]]),"aria-expanded":"false",type:"button"},[t(p,{name:"chevron-down"})],2)])]),o("div",{class:L([e.state.isExpanded?"block mt-2":"hidden"])},[W(e.$slots,"default"),e.caption?(s(),i("div",Me,[o("p",{class:"text-par-s text-lab-sc",innerHTML:e.caption},null,8,we)])):C("",!0)],2)])])}const Te=S(Ce,[["render",Le]]),Ie=P({setup(e,n){const u=H();return{metadata:$(()=>u.metadata),filter:u.filter}},components:{TextInput:I,SecondarySwitcher:re,Checkbox:$e,FilterBlock:Te,TextInput:I}}),Re={class:"block"},Ee={class:"flex gap-2"},Ue={class:"w-6/12"},He={class:"w-6/12"},qe={class:"block max-h-72 overflow-y-auto"},Ae={class:"block max-h-72 overflow-y-auto"},Ne={class:"block"},ze={class:"block"},Ge={class:"block"},De={class:"block max-h-72 overflow-y-auto"};function Qe(e,n,u,r,b,g){const p=a("TextInput"),d=a("FilterBlock"),m=a("Border"),f=a("Checkbox"),h=a("SecondarySwitcher");return s(),i("div",Re,[t(d,{title:e.$t("market.filter.price"),isExpanded:!0},{default:c(()=>[o("div",Ee,[o("div",Ue,[t(p,{hasLabel:!1,modelValue:e.filter.price.from,"onUpdate:modelValue":n[0]||(n[0]=l=>e.filter.price.from=l),modelModifiers:{trim:!0},placeholder:e.$t("market.filter.price_from"),inputType:"number"},null,8,["modelValue","placeholder"])]),o("div",He,[t(p,{hasLabel:!1,modelValue:e.filter.price.to,"onUpdate:modelValue":n[1]||(n[1]=l=>e.filter.price.to=l),modelModifiers:{trim:!0},placeholder:e.$t("market.filter.price_to"),inputType:"number"},null,8,["modelValue","placeholder"])])])]),_:1},8,["title"]),t(m),t(d,{title:e.$t("market.filter.currency"),isExpanded:!0},{default:c(()=>[o("div",qe,[(s(!0),i(k,null,B(e.metadata.filter.currencies,(l,_)=>(s(),i("div",{key:_,class:"block hover:bg-fill-qt p-1"},[t(f,{modelValue:e.filter.currencies[l.key],"onUpdate:modelValue":y=>e.filter.currencies[l.key]=y,name:l.key,label:l.value},null,8,["modelValue","onUpdate:modelValue","name","label"])]))),128))])]),_:1},8,["title"]),t(m),t(d,{title:e.$t("market.filter.condition"),isExpanded:!0},{default:c(()=>[o("div",Ae,[(s(!0),i(k,null,B(e.metadata.filter.conditions,(l,_)=>(s(),i("div",{key:_,class:"block hover:bg-fill-qt p-1"},[t(f,{modelValue:e.filter.conditions[l.key],"onUpdate:modelValue":y=>e.filter.conditions[l.key]=y,name:l.key,label:l.value},null,8,["modelValue","onUpdate:modelValue","name","label"])]))),128))])]),_:1},8,["title"]),t(m),t(d,{title:e.$t("market.filter.discount"),caption:e.$t("market.filter.discount_caption")},{default:c(()=>[o("div",Ne,[t(h,{modelValue:e.filter.with_discount,"onUpdate:modelValue":n[2]||(n[2]=l=>e.filter.with_discount=l),label:e.$t("market.filter.discount_label")},null,8,["modelValue","label"])])]),_:1},8,["title","caption"]),t(m),t(d,{title:e.$t("market.filter.rating"),caption:e.$t("market.filter.rating_caption")},{default:c(()=>[o("div",ze,[t(h,{modelValue:e.filter.high_rating,"onUpdate:modelValue":n[3]||(n[3]=l=>e.filter.high_rating=l),label:e.$t("market.filter.rating_label")},null,8,["modelValue","label"])])]),_:1},8,["title","caption"]),t(m),t(d,{title:e.$t("market.filter.store"),caption:e.$t("market.filter.store_caption")},{default:c(()=>[o("div",Ge,[t(h,{modelValue:e.filter.is_store,"onUpdate:modelValue":n[4]||(n[4]=l=>e.filter.is_store=l),label:e.$t("market.filter.store_label")},null,8,["modelValue","label"])])]),_:1},8,["title","caption"]),t(m),t(d,{title:e.$t("market.filter.type")},{default:c(()=>[o("div",De,[(s(!0),i(k,null,B(e.metadata.filter.types,(l,_)=>(s(),i("div",{key:_,class:"block hover:bg-fill-qt p-1"},[t(f,{modelValue:e.filter.types[l.key],"onUpdate:modelValue":y=>e.filter.types[l.key]=y,name:l.key,label:l.value},null,8,["modelValue","onUpdate:modelValue","name","label"])]))),128))])]),_:1},8,["title"])])}const je=S(Ie,[["render",Qe]]),Je=P({setup:function(){return{state:M({mainMenu:q()})}},components:{PageHeader:fe,PrimaryIconButton:A,RichMenu:ie,RichMenuItem:se}}),Ke={class:"relative"},Oe={class:"opacity-80 hover:opacity-100 translate-x-1"},We={key:0,class:"absolute top-full right-0 w-96 z-50"},Xe=["href"];function Ye(e,n,u,r,b,g){const p=a("PrimaryIconButton"),d=a("RichMenuItem"),m=a("Border"),f=a("RouterLink"),h=a("RichMenu"),l=a("PageHeader"),_=U("outside-click");return s(),v(l,{hasBack:!0,titleText:e.$t("market.market_title")},{default:c(()=>[o("div",Ke,[o("div",Oe,[t(p,{onClick:E(e.state.mainMenu.open,["stop"]),iconName:"plus"},null,8,["onClick"])]),e.state.mainMenu.status?R((s(),i("div",We,[t(h,null,{default:c(()=>[o("a",{href:e.$getRoute("business_dashboard_index"),target:"_blank",class:"block"},[t(d,{title:e.$t("market.nav_menu.create_product.title"),description:e.$t("market.nav_menu.create_product.description"),trailingIconName:"arrow-up-right",iconName:"shopping-bag-03",iconType:"solid"},null,8,["title","description"])],8,Xe),t(m),t(f,{to:{name:"saved_products"},class:"block"},{default:c(()=>[t(d,{title:e.$t("market.nav_menu.bookmarks.title"),description:e.$t("market.nav_menu.bookmarks.description"),trailingIconName:"arrow-up-right",iconName:"bookmark",iconType:"solid"},null,8,["title","description"])]),_:1})]),_:1})])),[[_,e.state.mainMenu.close]]):C("",!0)])]),_:1},8,["titleText"])}const Ze=S(Je,[["render",Ye]]),xe=P({setup:function(){const e=M({isLoading:!0,isSearchLoading:!1,noMoreContent:!1,isLoadingContent:!1,filterMenu:q(),isEmpty:!1}),n=T(null),u=T(null),r=H(),b=$(()=>r.categories),g=$(()=>r.filter),p=$(()=>r.products);X(async()=>{r.resetFilter(),await r.fetchCategories(),await r.fetchProducts(),await r.fetchMetadata(),debounce(()=>{p.value.length||(e.isEmpty=!0)},500),e.isLoading=!1}),Y(()=>{r.product=null}),x({callback:()=>{debounce(async()=>{!e.isLoadingContent&&!e.noMoreContent&&p.value.length&&(e.isLoadingContent=!0,r.filter.cursor=r.getLastProductId(),e.noMoreContent=!await r.loadMoreProducts(),e.isLoadingContent=!1)},200)}}),Z(u,()=>{r.filter.query=u.value,debounce(async()=>{await d()},500)});const d=async()=>{e.noMoreContent=!1,r.filter.cursor=null,e.isSearchLoading=!0,await r.fetchProducts(),e.isSearchLoading=!1,e.filterMenu.close()};return{activeFiltersCount:$(()=>r.activeFiltersCount),searchQuery:u,state:e,filter:g,products:p,categories:b,applyFilters:d,selectedCategory:n,selectCategory:f=>{r.filter.category_id==f.id?(r.filter.category_id=null,n.value=null):(r.filter.category_id=f.id,n.value=f)},resetFilter:async()=>{r.resetFilter(),u.value="",n.value=null,e.isLoading=!0,await r.fetchProducts(),e.isLoading=!1}}},components:{SidedContentLayout:oe,TimelineContainer:te,PrimaryPillButton:pe,ProductCard:ne,CategoriesFilter:ae,SearchBar:le,ProductsFilter:je,FluidEmptyState:me,BadgeCounter:ue,PrimaryIconButton:A,FollowRecommendationList:_e,AdGridItem:ee,PrimaryTextButton:ce,PopupPanel:de,CatalogHeader:Ze}}),et={key:0,class:"flex-center h-96"},tt={class:"sticky top-0 popup-background-tr z-10"},ot={class:"p-4"},nt={class:"mb-4"},at={class:"flex items-center"},lt={class:"text-par-l text-lab-pr2 font-semibold truncate"},rt={class:"flex items-center gap-2 ml-auto"},st={class:"relative"},it={class:"relative"},dt={class:"absolute -top-1 -right-1"},ct={key:0,class:"absolute top-8 -right-4 bottom-0 w-content"},ut={class:"popup-card bg-bg-pr"},pt={class:"p-4 border-b border-b-bord-pr"},mt={class:"text-par-l text-lab-pr2 font-semibold text-center"},ft={class:"overflow-y-auto h-[500px]"},_t={class:"p-4"},ht={class:"block px-4 py-4 border-t border-t-bord-pr"},kt={key:0,class:"flex-center h-96"},yt={key:0,class:"grid grid-cols-3 px-4 gap-4"};function bt(e,n,u,r,b,g){const p=a("CatalogHeader"),d=a("Border"),m=a("PrimarySpinAnimation"),f=a("SearchBar"),h=a("PrimaryTextButton"),l=a("BadgeCounter"),_=a("CategoriesFilter"),y=a("ProductsFilter"),N=a("PrimaryPillButton"),z=a("PopupPanel"),w=a("FluidEmptyState"),G=a("ProductCard"),D=a("RouterLink"),Q=a("TimelineContainer"),j=a("FollowRecommendationList"),J=a("AdGridItem"),K=a("SidedContentLayout"),O=U("outside-click");return s(),v(K,null,{content:c(()=>[t(Q,null,{default:c(()=>[t(p),t(d),e.state.isLoading?(s(),i("div",et,[t(m)])):(s(),i(k,{key:1},[o("div",tt,[o("div",ot,[o("div",nt,[t(f,{modelValue:e.searchQuery,"onUpdate:modelValue":n[0]||(n[0]=V=>e.searchQuery=V),modelModifiers:{trim:!0},placeholder:e.$t("labels.search")},null,8,["modelValue","placeholder"])]),o("div",at,[o("h4",lt,F(e.selectedCategory?e.selectedCategory.name:e.$t("labels.for_you")),1),o("div",rt,[e.activeFiltersCount?(s(),i(k,{key:0},[t(h,{buttonRole:"danger",onClick:e.resetFilter,buttonText:e.$t("market.reset_filters")},null,8,["onClick","buttonText"]),n[1]||(n[1]=o("div",{class:"w-px h-4 bg-bord-pr"},null,-1))],64)):C("",!0),o("div",st,[o("div",it,[t(h,{onClick:E(e.state.filterMenu.toggle,["stop"]),buttonRole:"marginal",buttonText:e.$t("labels.filters")},null,8,["onClick","buttonText"]),o("span",dt,[e.activeFiltersCount?(s(),v(l,{key:0,count:e.activeFiltersCount},null,8,["count"])):C("",!0)])]),e.state.filterMenu.status?R((s(),i("div",ct,[t(z,null,{default:c(()=>[o("div",ut,[o("div",pt,[o("h4",mt,F(e.$t("labels.filters")),1)]),o("div",ft,[o("div",_t,[t(_,{onSelect:e.selectCategory,selected:e.filter.category_id,categories:e.categories},null,8,["onSelect","selected","categories"])]),t(y)]),o("div",ht,[t(N,{onClick:e.applyFilters,buttonFluid:!0,width:"full",buttonText:e.$t("market.apply_filters")},null,8,["onClick","buttonText"])])])]),_:1})])),[[O,e.state.filterMenu.close]]):C("",!0)])])])])]),e.state.isEmpty?(s(),v(w,{key:0,text:e.$t("empty_state.empty"),iconType:"solid"},null,8,["text"])):(s(),i(k,{key:1},[e.state.isSearchLoading?(s(),i("div",kt,[t(m)])):(s(),i(k,{key:1},[e.products.length?(s(),i("div",yt,[(s(!0),i(k,null,B(e.products,V=>(s(),v(D,{class:"block",to:{name:"marketplace_show",params:{product_id:V.hash_id}}},{default:c(()=>[t(G,{productData:V},null,8,["productData"])]),_:2},1032,["to"]))),256))])):(s(),v(w,{key:1,text:e.$t("empty_state.market.filter"),iconType:"solid"},null,8,["text"]))],64))],64))],64))]),_:1})]),sidebar:c(()=>[t(j),t(J)]),_:1})}const qt=S(xe,[["render",bt]]);export{qt as default};
