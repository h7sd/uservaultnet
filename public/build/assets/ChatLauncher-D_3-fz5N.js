const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EmojisPicker-BXzUvyYH.js","assets/application-DEz9sPnz.js","assets/global.properties-DKM1fd6s.js","assets/editor-CpZ7vO5P.js","assets/media-D4ZD3EDk.js","assets/vendor-20TtR0Rd.js","assets/inbox.store-CHx7CB4w.js","assets/index-ciglwFMH.js","assets/ui-Bp8YvxdW.js"])))=>i.map(i=>d[i]);
import{_ as w,a as I,c as P}from"./global.properties-DKM1fd6s.js";import{k as D,e as s,c as p,d as c,s as t,i as n,v as y,x as j,p as T,t as u,q as B,y as k,z as x,K as A,F as E,B as H,b as $,r as h,o as O,l as V,H as L}from"./vendor-20TtR0Rd.js";import{u as R}from"./index-ciglwFMH.js";import{A as M}from"./AvatarMedium-Dt88Ycme.js";import{f as z,g as F,M as N,l as q,P as K}from"./application-DEz9sPnz.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./inbox.store-CHx7CB4w.js";import"./ui-Bp8YvxdW.js";const U=D({props:{profileData:{type:Object,required:!0}},setup:function(){return{}},components:{PrimaryPillButton:z,AvatarMedium:M}}),G={class:"block"},J={class:"flex justify-center"},Q={class:"w-content"},W={class:"flex justify-center"},X={class:"text-center my-2 flex flex-col gap-1"},Y={class:"text-title-3 font-bold text-lab-pr2"},Z={class:"block text-par-s text-lab-sc"},ee={key:0,class:"block text-par-s text-lab-sc"},te=["innerHTML"],oe={class:"block text-par-s text-lab-sc"},ae={class:"flex justify-center"};function se(e,o,_,g,m,v){const f=s("AvatarMedium"),i=s("VerificationBadge"),l=s("PrimaryPillButton"),r=s("RouterLink");return c(),p("div",G,[t("div",J,[t("div",Q,[t("div",W,[n(f,{avatarSrc:e.profileData.avatar_url},null,8,["avatarSrc"])]),t("div",X,[t("h1",Y,[j(u(e.profileData.name)+" ",1),e.profileData.verified?(c(),T(i,{key:0,size:"sm"})):y("",!0)]),t("span",Z,u(e.$t("labels.was_online_at",{time:e.profileData.last_active.formatted})),1),e.profileData.meta.relationship.follow.followed_by?(c(),p("span",ee,u(e.$t("labels.following_you_on",{app_name:e.$embedder("config.app.name")})),1)):y("",!0),e.profileData.description?(c(),p("span",{key:1,class:"block text-par-m text-lab-pr2 markdown-text",innerHTML:e.$mdInline(e.profileData.description)},null,8,te)):y("",!0),t("span",oe,u(e.profileData.followers_count.formatted)+" "+u(e.$t("labels.followers_count",e.profileData.followers_count.raw)),1)]),t("div",ae,[n(r,{to:{name:"profile_index",params:{id:e.profileData.username}}},{default:B(()=>[n(l,{buttonType:"submit",buttonSize:"md",buttonText:e.$t("labels.view_profile")},null,8,["buttonText"])]),_:1},8,["to"])])])])])}const ne=w(U,[["render",se]]),ie=D({props:{userId:{type:Number,required:!0},payload:{type:Object,default:{}}},emits:["close"],setup:function(e,o){const{autoResize:_,insertSymbolAtCaret:g}=R(),m=$({isEmojisPickerOpen:!1,isSubmitting:!1,isLoading:!0}),v=h(null),f=L(),i=h(null),l=$({content:""}),r=h(null),b=h(null);return O(async()=>{_(i.value),await P().messenger().with({user_id:e.userId}).sendTo("chats/launch").then(a=>{b.value=a.data.data.interlocutor,r.value=a.data.data.chat_id,v.value=a.data.data.validation_rules,m.isLoading=!1}).catch(a=>{a.response&&(o.emit("close"),alert(a.response.data.message))})}),{state:m,messageTextInputField:i,messageData:l,validationRules:v,isFormValid:V(()=>l.content.length>0),interlocutorData:b,textInputHandler:function(){_(i.value)},insertStoryEmoji:a=>{l.content=g(i.value,a),i.value.focus()},handleSubmit:()=>{m.isSubmitting=!0,P().messenger().with({chat_id:r.value,content:l.content,payload:e.payload}).sendTo("chats/launcher-send").then(a=>{l.content="",o.emit("close"),f.push({name:"messenger_chat",params:{chat_id:r.value}})}).catch(a=>{a.response&&alert(a.response.data.message),m.isSubmitting=!1})}}},components:{AvatarMedium:M,PrimaryIconButton:K,ContentModal:q,ProfileOverviewCard:ne,ModalHeader:N,PrimaryTextButton:F,EmojisPicker:H(()=>I(()=>import("./EmojisPicker-BXzUvyYH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])))}}),le={class:"block"},re={key:0,class:"flex py-20 justify-center"},de={class:"block py-8 px-4"},ce={class:"block"},ue={class:"relative"},me={class:"absolute bottom-3 left-4 text-lab-sc text-cap-l"},pe=["placeholder"],fe={class:"absolute right-2.5 bottom-1.5"},_e={class:"relative"},ve={key:0,class:"block absolute top-6 right-0 w-80 z-50"},be={class:"flex justify-center py-4"};function he(e,o,_,g,m,v){const f=s("ModalHeader"),i=s("PrimarySpinAnimation"),l=s("ProfileOverviewCard"),r=s("Border"),b=s("PrimaryIconButton"),a=s("EmojisPicker"),S=s("PrimaryTextButton"),C=s("ContentModal");return c(),T(C,{onClose:o[5]||(o[5]=d=>e.$emit("close"))},{default:B(()=>[t("div",le,[n(f,{modalTitle:e.$t("market.write_message")},null,8,["modalTitle"]),e.state.isLoading?(c(),p("div",re,[n(i)])):(c(),p(E,{key:1},[t("div",de,[n(l,{profileData:e.interlocutorData},null,8,["profileData"])]),t("div",ce,[t("form",{class:"block",onSubmit:o[4]||(o[4]=k((...d)=>e.handleSubmit&&e.handleSubmit(...d),["prevent"]))},[n(r,{height:"h-3"}),t("div",ue,[t("span",me,u(e.messageData.content.length)+"/"+u(e.validationRules.content.max),1),x(t("textarea",{ref:"messageTextInputField",onInput:o[0]||(o[0]=(...d)=>e.textInputHandler&&e.textInputHandler(...d)),"onUpdate:modelValue":o[1]||(o[1]=d=>e.messageData.content=d),class:"resize-none w-full pl-4 pr-12 leading-5 pt-3.5 pb-6 bg-transparent text-par-n text-lab-pr2 max-h-96 overflow-y-auto min-h-28 outline-hidden placeholder:font-light placeholder:text-par-s",placeholder:e.$t("chat.write_message")},null,40,pe),[[A,e.messageData.content]]),t("div",fe,[t("div",_e,[n(b,{onClick:o[2]||(o[2]=k(d=>e.state.isEmojisPickerOpen=!0,["stop"])),iconName:"face-smile",iconSize:"icon-small",iconType:"line",disabled:e.state.isSubmitting},null,8,["disabled"]),e.state.isEmojisPickerOpen?(c(),p("div",ve,[n(a,{onPick:e.insertStoryEmoji,onClose:o[3]||(o[3]=d=>e.state.isEmojisPickerOpen=!1)},null,8,["onPick"])])):y("",!0)])])]),n(r),t("div",be,[n(S,{disabled:!e.isFormValid,loading:e.state.isSubmitting,buttonText:e.$t("labels.send_message"),type:"submit"},null,8,["disabled","loading","buttonText"])])],32)])],64))])]),_:1})}const Me=w(ie,[["render",he]]);export{Me as default};
