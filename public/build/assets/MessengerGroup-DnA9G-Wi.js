import{c as f,_ as y,d as N,b as k}from"./global.properties-DKM1fd6s.js";import{u as x,k as L,e as c,c as p,d as o,i as r,F as b,p as m,q as v,s as n,t as h,f as B,I as H,x as C,v as g,b as P,l as G,o as A,H as M}from"./vendor-20TtR0Rd.js";import{T as E,b as F,j as D,d as V,i as j,g as q}from"./application-C3zsOS77.js";import{P as z,u as O}from"./ParticipantItem-SKbDq5OJ.js";import{A as R}from"./AvatarLarge-DzdSl14i.js";import{S as J}from"./SheetTitle-CCLXWnJ3.js";import"./editor-CpZ7vO5P.js";import"./media-D4ZD3EDk.js";import"./swiper-element-bundle-DBu82uhE.js";const w=x("mobile_chats_group",{state:()=>({groupData:null,groupParticipants:[]}),actions:{fetchGroupData:async function(t){await f().messenger().getFrom(`groups/${t}/show`).then(e=>{this.groupData=e.data.data}).catch(e=>{e.response&&(this.groupData=null)})},fetchGroupParticipants:async function(){await f().messenger().getFrom(`groups/${this.groupData.chat_id}/participants`).then(t=>{this.groupParticipants=t.data.data}).catch(t=>{t.response&&(this.groupParticipants=[])})}}}),K=L({components:{Toolbar:F,ToastNotification:E}});function Q(t,e,l,d,_,u){const s=c("ToastNotification"),a=c("Toolbar"),S=c("Border");return o(),p(b,null,[r(s),r(a,{onClose:e[0]||(e[0]=$=>t.$router.back()),title:t.$t("chat.group_info")},null,8,["title"]),r(S)],64)}const U=y(K,[["render",Q]]),W={},X={class:"w-full h-full flex justify-center items-center py-40"};function Y(t,e){const l=c("PrimarySpinAnimation");return o(),p("div",X,[r(l)])}const Z=y(W,[["render",Y]]),tt=L({props:{groupData:{type:Object,required:!0}},setup:function(t,e){const l=P({isLoading:!0}),d=w(),_=G(()=>d.groupParticipants);return A(async()=>{try{await d.fetchGroupParticipants(),l.isLoading=!1}catch(u){alert(u)}}),{groupParticipants:_,state:l}},components:{ParticipantItem:z,ActionSheet:V,ActionSheetGroup:D,SheetTitle:J}}),et={class:"mb-4 px-4 text-center"},at={class:"text-par-n text-lab-sc mt-1"},ot={key:0,class:"block"},nt={key:1},it={class:"block max-h-[500px] overflow-y-auto py-1"},st={class:"text-par-n text-green-900"},rt={class:"text-par-n text-green-900"};function ct(t,e,l,d,_,u){const s=c("SheetTitle"),a=c("ParticipantItem"),S=c("ActionSheetGroup"),$=c("ActionSheet");return o(),m($,{isMuted:!0},{default:v(()=>[n("div",et,[r(s,{title:t.$t("chat.participants_count",{count:t.groupData.participants_count.formatted})},null,8,["title"]),n("p",at,h(t.$t("chat.participant_add_rights")),1)]),t.state.isLoading?(o(),p("div",ot,e[0]||(e[0]=[n("div",{class:"flex-center h-24"},[n("div",{class:"colibri-primary-animation"})],-1)]))):(o(),p("div",nt,[r(S,null,{default:v(()=>[n("div",it,[(o(!0),p(b,null,B(t.groupParticipants,i=>(o(),m(a,{name:i.relations.user.name,caption:t.$t("labels.was_online_at",{time:i.relations.user.last_active.time_ago}),verified:i.relations.user.verified,avatarSrc:i.relations.user.avatar_url,username:i.relations.user.username},H({_:2},[i.meta.is_admin?{name:"caption",fn:v(()=>[n("span",st,[C(" ~ "+h(t.$t("chat.group_admin"))+" ",1),i.relations.user.is_auth_user?(o(),p(b,{key:0},[C(" ~ "+h(t.$t("labels.you")),1)],64)):g("",!0)])]),key:"0"}:i.relations.user.is_auth_user?{name:"caption",fn:v(()=>[n("span",rt," ~ "+h(t.$t("labels.you")),1)]),key:"1"}:void 0]),1032,["name","caption","verified","avatarSrc","username"]))),256))])]),_:1})]))]),_:1})}const pt=y(tt,[["render",ct]]),lt=L({props:{chat_id:{type:String,required:!0}},setup:function(t){const e=M(),l=q(),d=w(),_=O(),u=P({isLoading:!0,isSubmitting:!1,groupParticipantsMenu:N()}),s=G(()=>d.groupData);return A(async()=>{await d.fetchGroupData(t.chat_id),s.value?u.isLoading=!1:e.push({name:"error_404"})}),{state:u,groupData:s,hasDescription:G(()=>s.value.description.length>0),declineInvitation:async()=>{k.emit("confirmation-modal:open",{title:__t("prompt.decline_invitation.title"),description:__t("prompt.decline_invitation.description"),confirmButtonText:__t("prompt.decline_invitation.confirm"),onConfirm:()=>{f().messenger().with({chat_id:t.chat_id}).sendTo("groups/invite/decline").then(a=>{}).catch(a=>{a.response&&toastError(a.response.data.message)}),e.push({name:"messenger_index"}),toastSuccess(__t("toast.chat.declined_invitation",{name:s.value.name}))}})},acceptInvitation:async()=>{u.isSubmitting=!0,await f().messenger().with({chat_id:t.chat_id}).sendTo("groups/invite/accept").then(a=>{e.push({name:"messenger_chat",params:{chat_id:t.chat_id}}),l.fetchChatsHistory(),toastSuccess(__t("toast.chat.joined_group",{name:s.value.name}))}).catch(a=>{a.response&&toastError(a.response.data.message)}),u.isSubmitting=!1},archiveChat:async()=>{await _.archiveChat(t.chat_id),s.value.meta.is_archived=!0,toastSuccess(__t("toast.chat.chat_archived")),e.push({name:"messenger_index"})},unarchiveChat:async()=>{await _.unarchiveChat(t.chat_id),s.value.meta.is_archived=!1,toastSuccess(__t("toast.chat.chat_unarchived"))},reportGroup:()=>{k.emit("report:open",{type:"group",reportableId:s.value.id})},leaveGroup:async()=>{k.emit("confirmation-modal:open",{title:__t("prompt.leave_group.title"),description:__t("prompt.leave_group.description"),confirmButtonText:__t("prompt.leave_group.confirm"),onConfirm:()=>{f().messenger().with({chat_id:t.chat_id}).sendTo("groups/leave").then(a=>{}).catch(a=>{a.response&&toastError(a.response.data.message)}),e.push({name:"messenger_index"}),l.removeChatFromHistory(t.chat_id),toastSuccess(__t("toast.chat.left_group",{name:s.value.name}))}})},deleteGroup:async()=>{k.emit("confirmation-modal:open",{title:__t("prompt.delete_group.title"),description:__t("prompt.delete_group.description"),confirmButtonText:__t("prompt.delete_group.confirm"),onConfirm:()=>{f().messenger().with({chat_id:t.chat_id}).delete("groups/delete").then(a=>{}).catch(a=>{a.response&&toastError(a.response.data.message)}),e.push({name:"messenger_index"}),l.removeChatFromHistory(t.chat_id),toastSuccess(__t("toast.chat.delete_group",{name:s.value.name}))}})}}},components:{GroupHeader:U,GroupSkeleton:Z,AvatarLarge:R,ActionSheetGroup:D,ActionSheetItem:j,GroupParticipants:pt}}),ut={key:1,class:"bg-fill-qt min-h-screen"},dt={class:"p-4"},mt={class:"mb-4"},ht={class:"flex justify-center mb-2"},_t={class:"size-large-avatar relative"},gt={class:"px-4 text-center"},ft={class:"text-par-l font-bold text-lab-pr"},vt=["innerHTML"],bt={class:"text-par-m text-lab-sc"},St={key:0,class:"bg-bg-pr rounded-2xl p-4"},$t={class:"font-medium text-lab-sc mb-2 text-par-m"},kt=["innerHTML"],yt={key:0,class:"mt-4"},Ct={class:"px-4 py-4"},Gt={class:"text-lab-sc text-cap-l block text-center"};function Lt(t,e,l,d,_,u){const s=c("GroupHeader"),a=c("GroupSkeleton"),S=c("AvatarLarge"),$=c("VerificationBadge"),i=c("ActionSheetItem"),T=c("ActionSheetGroup"),I=c("GroupParticipants");return o(),p(b,null,[r(s),t.state.isLoading?(o(),m(a,{key:0})):(o(),p("div",ut,[n("div",dt,[n("div",mt,[n("div",ht,[n("div",_t,[r(S,{hasBorder:!1,avatarSrc:t.groupData.avatar_url},null,8,["avatarSrc"])])]),n("div",gt,[n("h2",ft,[n("span",{innerHTML:t.groupData.name},null,8,vt),e[0]||(e[0]=C()),t.groupData.verified?(o(),m($,{key:0,size:"sm"})):g("",!0)]),n("p",bt,h(t.$t("labels.group"))+" â€” "+h(t.$t("chat.participants_count",{count:t.groupData.participants_count.formatted})),1)])]),t.hasDescription?(o(),p("div",St,[n("h5",$t,h(t.$t("chat.about_group")),1),n("p",{class:"text-par-l text-lab-pr2 markdown-text",innerHTML:t.$mdInline(t.groupData.description,{breaks:!1})},null,8,kt)])):g("",!0)]),r(T,null,{default:v(()=>[r(i,{onClick:t.state.groupParticipantsMenu.open,textLabel:t.$t("chat.group_participants",{count:t.groupData.participants_count.formatted}),iconName:"users-01"},null,8,["onClick","textLabel"]),t.groupData.meta.is_participant||t.groupData.is_owner?(o(),p(b,{key:0},[t.groupData.meta.is_archived?(o(),m(i,{key:0,onClick:t.unarchiveChat,disabled:t.state.isSubmitting,textLabel:t.$t("chat.unarchive_chat"),iconName:"inbox-01"},null,8,["onClick","disabled","textLabel"])):(o(),m(i,{key:1,onClick:t.archiveChat,disabled:t.state.isSubmitting,textLabel:t.$t("chat.archive_chat"),iconName:"archive"},null,8,["onClick","disabled","textLabel"])),t.groupData.is_owner?(o(),m(i,{key:2,onClick:t.deleteGroup,disabled:t.state.isSubmitting,itemColor:"text-red-900",textLabel:t.$t("chat.delete_group"),iconName:"trash-04"},null,8,["onClick","disabled","textLabel"])):(o(),p(b,{key:3},[r(i,{onClick:t.reportGroup,disabled:t.state.isSubmitting,itemColor:"text-red-900",textLabel:t.$t("chat.report_group"),iconName:"annotation-alert"},null,8,["onClick","disabled","textLabel"]),r(i,{onClick:t.leaveGroup,disabled:t.state.isSubmitting,textLabel:t.$t("chat.leave_group"),itemColor:"text-red-900",iconName:"log-out-01",iconType:"solid"},null,8,["onClick","disabled","textLabel"])],64))],64)):g("",!0)]),_:1}),t.groupData.meta.is_invited?(o(),p("div",yt,[r(T,null,{default:v(()=>[r(i,{onClick:t.acceptInvitation,disabled:t.state.isSubmitting,textLabel:t.$t("dd.chat_participant.accept_invitation"),iconName:"users-check"},null,8,["onClick","disabled","textLabel"]),r(i,{onClick:t.declineInvitation,disabled:t.state.isSubmitting,itemColor:"text-red-900",textLabel:t.$t("dd.chat_participant.decline_invitation"),iconName:"slash-circle-01",iconType:"line"},null,8,["onClick","disabled","textLabel"])]),_:1})])):g("",!0),n("div",Ct,[n("span",Gt,h(t.$t("chat.group_created_date",{date:t.groupData.date.iso})),1)])])),t.state.groupParticipantsMenu.status?(o(),m(I,{key:2,groupData:t.groupData,onClose:t.state.groupParticipantsMenu.close},null,8,["groupData","onClose"])):g("",!0)],64)}const Ht=y(lt,[["render",Lt]]);export{Ht as default};
